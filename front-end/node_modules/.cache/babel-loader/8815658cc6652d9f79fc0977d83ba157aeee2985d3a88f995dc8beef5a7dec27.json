{"ast":null,"code":"'use strict';\n\nconst Document = require('../document');\nconst immediate = require('../helpers/immediate');\nconst internalToObjectOptions = require('../options').internalToObjectOptions;\nconst promiseOrCallback = require('../helpers/promiseOrCallback');\nconst util = require('util');\nconst utils = require('../utils');\nmodule.exports = Subdocument;\n\n/**\r\n * Subdocument constructor.\r\n *\r\n * @inherits Document\r\n * @api private\r\n */\n\nfunction Subdocument(value, fields, parent, skipId, options) {\n  if (parent != null) {\n    // If setting a nested path, should copy isNew from parent re: gh-7048\n    const parentOptions = {\n      isNew: parent.isNew\n    };\n    if ('defaults' in parent.$__) {\n      parentOptions.defaults = parent.$__.defaults;\n    }\n    options = Object.assign(parentOptions, options);\n  }\n  if (options != null && options.path != null) {\n    this.$basePath = options.path;\n  }\n  Document.call(this, value, fields, skipId, options);\n  delete this.$__.priorDoc;\n}\nSubdocument.prototype = Object.create(Document.prototype);\nObject.defineProperty(Subdocument.prototype, '$isSubdocument', {\n  configurable: false,\n  writable: false,\n  value: true\n});\nObject.defineProperty(Subdocument.prototype, '$isSingleNested', {\n  configurable: false,\n  writable: false,\n  value: true\n});\n\n/*!\r\n * ignore\r\n */\n\nSubdocument.prototype.toBSON = function () {\n  return this.toObject(internalToObjectOptions);\n};\n\n/**\r\n * Used as a stub for middleware\r\n *\r\n * #### Note:\r\n *\r\n * _This is a no-op. Does not actually save the doc to the db._\r\n *\r\n * @param {Function} [fn]\r\n * @return {Promise} resolved Promise\r\n * @api private\r\n */\n\nSubdocument.prototype.save = function (options, fn) {\n  if (typeof options === 'function') {\n    fn = options;\n    options = {};\n  }\n  options = options || {};\n  if (!options.suppressWarning) {\n    utils.warn('mongoose: calling `save()` on a subdoc does **not** save ' + 'the document to MongoDB, it only runs save middleware. ' + 'Use `subdoc.save({ suppressWarning: true })` to hide this warning ' + 'if you\\'re sure this behavior is right for your app.');\n  }\n  return promiseOrCallback(fn, cb => {\n    this.$__save(cb);\n  });\n};\n\n/**\r\n * Given a path relative to this document, return the path relative\r\n * to the top-level document.\r\n * @param {String} path\r\n * @method $__fullPath\r\n * @memberOf Subdocument\r\n * @instance\r\n * @returns {String}\r\n * @api private\r\n */\n\nSubdocument.prototype.$__fullPath = function (path) {\n  if (!this.$__.fullPath) {\n    this.ownerDocument();\n  }\n  return path ? this.$__.fullPath + '.' + path : this.$__.fullPath;\n};\n\n/**\r\n * Given a path relative to this document, return the path relative\r\n * to the top-level document.\r\n * @param {String} p\r\n * @returns {String}\r\n * @method $__pathRelativeToParent\r\n * @memberOf Subdocument\r\n * @instance\r\n * @api private\r\n */\n\nSubdocument.prototype.$__pathRelativeToParent = function (p) {\n  if (p == null) {\n    return this.$basePath;\n  }\n  return [this.$basePath, p].join('.');\n};\n\n/**\r\n * Used as a stub for middleware\r\n *\r\n * #### Note:\r\n *\r\n * _This is a no-op. Does not actually save the doc to the db._\r\n *\r\n * @param {Function} [fn]\r\n * @method $__save\r\n * @api private\r\n */\n\nSubdocument.prototype.$__save = function (fn) {\n  return immediate(() => fn(null, this));\n};\n\n/*!\r\n * ignore\r\n */\n\nSubdocument.prototype.$isValid = function (path) {\n  const parent = this.$parent();\n  const fullPath = this.$__pathRelativeToParent(path);\n  if (parent != null && fullPath != null) {\n    return parent.$isValid(fullPath);\n  }\n  return Document.prototype.$isValid.call(this, path);\n};\n\n/*!\r\n * ignore\r\n */\n\nSubdocument.prototype.markModified = function (path) {\n  Document.prototype.markModified.call(this, path);\n  const parent = this.$parent();\n  const fullPath = this.$__pathRelativeToParent(path);\n  if (parent == null || fullPath == null) {\n    return;\n  }\n  const myPath = this.$__pathRelativeToParent().replace(/\\.$/, '');\n  if (parent.isDirectModified(myPath) || this.isNew) {\n    return;\n  }\n  this.$__parent.markModified(fullPath, this);\n};\n\n/*!\r\n * ignore\r\n */\n\nSubdocument.prototype.isModified = function (paths, modifiedPaths) {\n  const parent = this.$parent();\n  if (parent != null) {\n    if (Array.isArray(paths) || typeof paths === 'string') {\n      paths = Array.isArray(paths) ? paths : paths.split(' ');\n      paths = paths.map(p => this.$__pathRelativeToParent(p)).filter(p => p != null);\n    } else if (!paths) {\n      paths = this.$__pathRelativeToParent();\n    }\n    return parent.$isModified(paths, modifiedPaths);\n  }\n  return Document.prototype.isModified.call(this, paths, modifiedPaths);\n};\n\n/**\r\n * Marks a path as valid, removing existing validation errors.\r\n *\r\n * @param {String} path the field to mark as valid\r\n * @api private\r\n * @method $markValid\r\n * @memberOf Subdocument\r\n */\n\nSubdocument.prototype.$markValid = function (path) {\n  Document.prototype.$markValid.call(this, path);\n  const parent = this.$parent();\n  const fullPath = this.$__pathRelativeToParent(path);\n  if (parent != null && fullPath != null) {\n    parent.$markValid(fullPath);\n  }\n};\n\n/*!\r\n * ignore\r\n */\n\nSubdocument.prototype.invalidate = function (path, err, val) {\n  Document.prototype.invalidate.call(this, path, err, val);\n  const parent = this.$parent();\n  const fullPath = this.$__pathRelativeToParent(path);\n  if (parent != null && fullPath != null) {\n    parent.invalidate(fullPath, err, val);\n  } else if (err.kind === 'cast' || err.name === 'CastError' || fullPath == null) {\n    throw err;\n  }\n  return this.ownerDocument().$__.validationError;\n};\n\n/*!\r\n * ignore\r\n */\n\nSubdocument.prototype.$ignore = function (path) {\n  Document.prototype.$ignore.call(this, path);\n  const parent = this.$parent();\n  const fullPath = this.$__pathRelativeToParent(path);\n  if (parent != null && fullPath != null) {\n    parent.$ignore(fullPath);\n  }\n};\n\n/**\r\n * Returns the top level document of this sub-document.\r\n *\r\n * @return {Document}\r\n */\n\nSubdocument.prototype.ownerDocument = function () {\n  if (this.$__.ownerDocument) {\n    return this.$__.ownerDocument;\n  }\n  let parent = this; // eslint-disable-line consistent-this\n  const paths = [];\n  const seenDocs = new Set([parent]);\n  while (true) {\n    if (typeof parent.$__pathRelativeToParent !== 'function') {\n      break;\n    }\n    paths.unshift(parent.$__pathRelativeToParent(void 0, true));\n    const _parent = parent.$parent();\n    if (_parent == null) {\n      break;\n    }\n    parent = _parent;\n    if (seenDocs.has(parent)) {\n      throw new Error('Infinite subdocument loop: subdoc with _id ' + parent._id + ' is a parent of itself');\n    }\n    seenDocs.add(parent);\n  }\n  this.$__.fullPath = paths.join('.');\n  this.$__.ownerDocument = parent;\n  return this.$__.ownerDocument;\n};\n\n/*!\r\n * ignore\r\n */\n\nSubdocument.prototype.$__fullPathWithIndexes = function () {\n  let parent = this; // eslint-disable-line consistent-this\n  const paths = [];\n  const seenDocs = new Set([parent]);\n  while (true) {\n    if (typeof parent.$__pathRelativeToParent !== 'function') {\n      break;\n    }\n    paths.unshift(parent.$__pathRelativeToParent(void 0, false));\n    const _parent = parent.$parent();\n    if (_parent == null) {\n      break;\n    }\n    parent = _parent;\n    if (seenDocs.has(parent)) {\n      throw new Error('Infinite subdocument loop: subdoc with _id ' + parent._id + ' is a parent of itself');\n    }\n    seenDocs.add(parent);\n  }\n  return paths.join('.');\n};\n\n/**\r\n * Returns this sub-documents parent document.\r\n *\r\n * @api public\r\n */\n\nSubdocument.prototype.parent = function () {\n  return this.$__parent;\n};\n\n/**\r\n * Returns this sub-documents parent document.\r\n *\r\n * @api public\r\n * @method $parent\r\n */\n\nSubdocument.prototype.$parent = Subdocument.prototype.parent;\n\n/**\r\n * no-op for hooks\r\n * @param {Function} cb\r\n * @method $__remove\r\n * @memberOf Subdocument\r\n * @instance\r\n * @api private\r\n */\n\nSubdocument.prototype.$__remove = function (cb) {\n  if (cb == null) {\n    return;\n  }\n  return cb(null, this);\n};\n\n/**\r\n * ignore\r\n * @method $__removeFromParent\r\n * @memberOf Subdocument\r\n * @instance\r\n * @api private\r\n */\n\nSubdocument.prototype.$__removeFromParent = function () {\n  this.$__parent.set(this.$basePath, null);\n};\n\n/**\r\n * Null-out this subdoc\r\n *\r\n * @param {Object} [options]\r\n * @param {Function} [callback] optional callback for compatibility with Document.prototype.remove\r\n */\n\nSubdocument.prototype.remove = function (options, callback) {\n  if (typeof options === 'function') {\n    callback = options;\n    options = null;\n  }\n  registerRemoveListener(this);\n\n  // If removing entire doc, no need to remove subdoc\n  if (!options || !options.noop) {\n    this.$__removeFromParent();\n  }\n  return this.$__remove(callback);\n};\n\n/*!\r\n * ignore\r\n */\n\nSubdocument.prototype.populate = function () {\n  throw new Error('Mongoose does not support calling populate() on nested ' + 'docs. Instead of `doc.nested.populate(\"path\")`, use ' + '`doc.populate(\"nested.path\")`');\n};\n\n/**\r\n * Helper for console.log\r\n *\r\n * @api public\r\n */\n\nSubdocument.prototype.inspect = function () {\n  return this.toObject({\n    transform: false,\n    virtuals: false,\n    flattenDecimals: false\n  });\n};\nif (util.inspect.custom) {\n  // Avoid Node deprecation warning DEP0079\n  Subdocument.prototype[util.inspect.custom] = Subdocument.prototype.inspect;\n}\n\n/**\r\n * Registers remove event listeners for triggering\r\n * on subdocuments.\r\n *\r\n * @param {Subdocument} sub\r\n * @api private\r\n */\n\nfunction registerRemoveListener(sub) {\n  let owner = sub.ownerDocument();\n  function emitRemove() {\n    owner.$removeListener('save', emitRemove);\n    owner.$removeListener('remove', emitRemove);\n    sub.emit('remove', sub);\n    sub.constructor.emit('remove', sub);\n    owner = sub = null;\n  }\n  owner.$on('save', emitRemove);\n  owner.$on('remove', emitRemove);\n}","map":{"version":3,"names":["Document","require","immediate","internalToObjectOptions","promiseOrCallback","util","utils","module","exports","Subdocument","value","fields","parent","skipId","options","parentOptions","isNew","$__","defaults","Object","assign","path","$basePath","call","priorDoc","prototype","create","defineProperty","configurable","writable","toBSON","toObject","save","fn","suppressWarning","warn","cb","$__save","$__fullPath","fullPath","ownerDocument","$__pathRelativeToParent","p","join","$isValid","$parent","markModified","myPath","replace","isDirectModified","$__parent","isModified","paths","modifiedPaths","Array","isArray","split","map","filter","$isModified","$markValid","invalidate","err","val","kind","name","validationError","$ignore","seenDocs","Set","unshift","_parent","has","Error","_id","add","$__fullPathWithIndexes","$__remove","$__removeFromParent","set","remove","callback","registerRemoveListener","noop","populate","inspect","transform","virtuals","flattenDecimals","custom","sub","owner","emitRemove","$removeListener","emit","constructor","$on"],"sources":["C:/Users/91930/Desktop/Github projects/Pharmacy Demo/back-end/node_modules/mongoose/lib/types/subdocument.js"],"sourcesContent":["'use strict';\r\n\r\nconst Document = require('../document');\r\nconst immediate = require('../helpers/immediate');\r\nconst internalToObjectOptions = require('../options').internalToObjectOptions;\r\nconst promiseOrCallback = require('../helpers/promiseOrCallback');\r\nconst util = require('util');\r\nconst utils = require('../utils');\r\n\r\nmodule.exports = Subdocument;\r\n\r\n/**\r\n * Subdocument constructor.\r\n *\r\n * @inherits Document\r\n * @api private\r\n */\r\n\r\nfunction Subdocument(value, fields, parent, skipId, options) {\r\n  if (parent != null) {\r\n    // If setting a nested path, should copy isNew from parent re: gh-7048\r\n    const parentOptions = { isNew: parent.isNew };\r\n    if ('defaults' in parent.$__) {\r\n      parentOptions.defaults = parent.$__.defaults;\r\n    }\r\n    options = Object.assign(parentOptions, options);\r\n  }\r\n  if (options != null && options.path != null) {\r\n    this.$basePath = options.path;\r\n  }\r\n  Document.call(this, value, fields, skipId, options);\r\n\r\n  delete this.$__.priorDoc;\r\n}\r\n\r\nSubdocument.prototype = Object.create(Document.prototype);\r\n\r\nObject.defineProperty(Subdocument.prototype, '$isSubdocument', {\r\n  configurable: false,\r\n  writable: false,\r\n  value: true\r\n});\r\n\r\nObject.defineProperty(Subdocument.prototype, '$isSingleNested', {\r\n  configurable: false,\r\n  writable: false,\r\n  value: true\r\n});\r\n\r\n/*!\r\n * ignore\r\n */\r\n\r\nSubdocument.prototype.toBSON = function() {\r\n  return this.toObject(internalToObjectOptions);\r\n};\r\n\r\n/**\r\n * Used as a stub for middleware\r\n *\r\n * #### Note:\r\n *\r\n * _This is a no-op. Does not actually save the doc to the db._\r\n *\r\n * @param {Function} [fn]\r\n * @return {Promise} resolved Promise\r\n * @api private\r\n */\r\n\r\nSubdocument.prototype.save = function(options, fn) {\r\n  if (typeof options === 'function') {\r\n    fn = options;\r\n    options = {};\r\n  }\r\n  options = options || {};\r\n\r\n  if (!options.suppressWarning) {\r\n    utils.warn('mongoose: calling `save()` on a subdoc does **not** save ' +\r\n      'the document to MongoDB, it only runs save middleware. ' +\r\n      'Use `subdoc.save({ suppressWarning: true })` to hide this warning ' +\r\n      'if you\\'re sure this behavior is right for your app.');\r\n  }\r\n\r\n  return promiseOrCallback(fn, cb => {\r\n    this.$__save(cb);\r\n  });\r\n};\r\n\r\n/**\r\n * Given a path relative to this document, return the path relative\r\n * to the top-level document.\r\n * @param {String} path\r\n * @method $__fullPath\r\n * @memberOf Subdocument\r\n * @instance\r\n * @returns {String}\r\n * @api private\r\n */\r\n\r\nSubdocument.prototype.$__fullPath = function(path) {\r\n  if (!this.$__.fullPath) {\r\n    this.ownerDocument();\r\n  }\r\n\r\n  return path ?\r\n    this.$__.fullPath + '.' + path :\r\n    this.$__.fullPath;\r\n};\r\n\r\n/**\r\n * Given a path relative to this document, return the path relative\r\n * to the top-level document.\r\n * @param {String} p\r\n * @returns {String}\r\n * @method $__pathRelativeToParent\r\n * @memberOf Subdocument\r\n * @instance\r\n * @api private\r\n */\r\n\r\nSubdocument.prototype.$__pathRelativeToParent = function(p) {\r\n  if (p == null) {\r\n    return this.$basePath;\r\n  }\r\n  return [this.$basePath, p].join('.');\r\n};\r\n\r\n/**\r\n * Used as a stub for middleware\r\n *\r\n * #### Note:\r\n *\r\n * _This is a no-op. Does not actually save the doc to the db._\r\n *\r\n * @param {Function} [fn]\r\n * @method $__save\r\n * @api private\r\n */\r\n\r\nSubdocument.prototype.$__save = function(fn) {\r\n  return immediate(() => fn(null, this));\r\n};\r\n\r\n/*!\r\n * ignore\r\n */\r\n\r\nSubdocument.prototype.$isValid = function(path) {\r\n  const parent = this.$parent();\r\n  const fullPath = this.$__pathRelativeToParent(path);\r\n  if (parent != null && fullPath != null) {\r\n    return parent.$isValid(fullPath);\r\n  }\r\n  return Document.prototype.$isValid.call(this, path);\r\n};\r\n\r\n/*!\r\n * ignore\r\n */\r\n\r\nSubdocument.prototype.markModified = function(path) {\r\n  Document.prototype.markModified.call(this, path);\r\n  const parent = this.$parent();\r\n  const fullPath = this.$__pathRelativeToParent(path);\r\n\r\n  if (parent == null || fullPath == null) {\r\n    return;\r\n  }\r\n\r\n  const myPath = this.$__pathRelativeToParent().replace(/\\.$/, '');\r\n  if (parent.isDirectModified(myPath) || this.isNew) {\r\n    return;\r\n  }\r\n  this.$__parent.markModified(fullPath, this);\r\n};\r\n\r\n/*!\r\n * ignore\r\n */\r\n\r\nSubdocument.prototype.isModified = function(paths, modifiedPaths) {\r\n  const parent = this.$parent();\r\n  if (parent != null) {\r\n    if (Array.isArray(paths) || typeof paths === 'string') {\r\n      paths = (Array.isArray(paths) ? paths : paths.split(' '));\r\n      paths = paths.map(p => this.$__pathRelativeToParent(p)).filter(p => p != null);\r\n    } else if (!paths) {\r\n      paths = this.$__pathRelativeToParent();\r\n    }\r\n\r\n    return parent.$isModified(paths, modifiedPaths);\r\n  }\r\n\r\n  return Document.prototype.isModified.call(this, paths, modifiedPaths);\r\n};\r\n\r\n/**\r\n * Marks a path as valid, removing existing validation errors.\r\n *\r\n * @param {String} path the field to mark as valid\r\n * @api private\r\n * @method $markValid\r\n * @memberOf Subdocument\r\n */\r\n\r\nSubdocument.prototype.$markValid = function(path) {\r\n  Document.prototype.$markValid.call(this, path);\r\n  const parent = this.$parent();\r\n  const fullPath = this.$__pathRelativeToParent(path);\r\n  if (parent != null && fullPath != null) {\r\n    parent.$markValid(fullPath);\r\n  }\r\n};\r\n\r\n/*!\r\n * ignore\r\n */\r\n\r\nSubdocument.prototype.invalidate = function(path, err, val) {\r\n  Document.prototype.invalidate.call(this, path, err, val);\r\n\r\n  const parent = this.$parent();\r\n  const fullPath = this.$__pathRelativeToParent(path);\r\n  if (parent != null && fullPath != null) {\r\n    parent.invalidate(fullPath, err, val);\r\n  } else if (err.kind === 'cast' || err.name === 'CastError' || fullPath == null) {\r\n    throw err;\r\n  }\r\n\r\n  return this.ownerDocument().$__.validationError;\r\n};\r\n\r\n/*!\r\n * ignore\r\n */\r\n\r\nSubdocument.prototype.$ignore = function(path) {\r\n  Document.prototype.$ignore.call(this, path);\r\n  const parent = this.$parent();\r\n  const fullPath = this.$__pathRelativeToParent(path);\r\n  if (parent != null && fullPath != null) {\r\n    parent.$ignore(fullPath);\r\n  }\r\n};\r\n\r\n/**\r\n * Returns the top level document of this sub-document.\r\n *\r\n * @return {Document}\r\n */\r\n\r\nSubdocument.prototype.ownerDocument = function() {\r\n  if (this.$__.ownerDocument) {\r\n    return this.$__.ownerDocument;\r\n  }\r\n\r\n  let parent = this; // eslint-disable-line consistent-this\r\n  const paths = [];\r\n  const seenDocs = new Set([parent]);\r\n\r\n  while (true) {\r\n    if (typeof parent.$__pathRelativeToParent !== 'function') {\r\n      break;\r\n    }\r\n    paths.unshift(parent.$__pathRelativeToParent(void 0, true));\r\n    const _parent = parent.$parent();\r\n    if (_parent == null) {\r\n      break;\r\n    }\r\n    parent = _parent;\r\n    if (seenDocs.has(parent)) {\r\n      throw new Error('Infinite subdocument loop: subdoc with _id ' + parent._id + ' is a parent of itself');\r\n    }\r\n\r\n    seenDocs.add(parent);\r\n  }\r\n\r\n  this.$__.fullPath = paths.join('.');\r\n\r\n  this.$__.ownerDocument = parent;\r\n  return this.$__.ownerDocument;\r\n};\r\n\r\n/*!\r\n * ignore\r\n */\r\n\r\nSubdocument.prototype.$__fullPathWithIndexes = function() {\r\n  let parent = this; // eslint-disable-line consistent-this\r\n  const paths = [];\r\n  const seenDocs = new Set([parent]);\r\n\r\n  while (true) {\r\n    if (typeof parent.$__pathRelativeToParent !== 'function') {\r\n      break;\r\n    }\r\n    paths.unshift(parent.$__pathRelativeToParent(void 0, false));\r\n    const _parent = parent.$parent();\r\n    if (_parent == null) {\r\n      break;\r\n    }\r\n    parent = _parent;\r\n    if (seenDocs.has(parent)) {\r\n      throw new Error('Infinite subdocument loop: subdoc with _id ' + parent._id + ' is a parent of itself');\r\n    }\r\n\r\n    seenDocs.add(parent);\r\n  }\r\n\r\n  return paths.join('.');\r\n};\r\n\r\n/**\r\n * Returns this sub-documents parent document.\r\n *\r\n * @api public\r\n */\r\n\r\nSubdocument.prototype.parent = function() {\r\n  return this.$__parent;\r\n};\r\n\r\n/**\r\n * Returns this sub-documents parent document.\r\n *\r\n * @api public\r\n * @method $parent\r\n */\r\n\r\nSubdocument.prototype.$parent = Subdocument.prototype.parent;\r\n\r\n/**\r\n * no-op for hooks\r\n * @param {Function} cb\r\n * @method $__remove\r\n * @memberOf Subdocument\r\n * @instance\r\n * @api private\r\n */\r\n\r\nSubdocument.prototype.$__remove = function(cb) {\r\n  if (cb == null) {\r\n    return;\r\n  }\r\n  return cb(null, this);\r\n};\r\n\r\n/**\r\n * ignore\r\n * @method $__removeFromParent\r\n * @memberOf Subdocument\r\n * @instance\r\n * @api private\r\n */\r\n\r\nSubdocument.prototype.$__removeFromParent = function() {\r\n  this.$__parent.set(this.$basePath, null);\r\n};\r\n\r\n/**\r\n * Null-out this subdoc\r\n *\r\n * @param {Object} [options]\r\n * @param {Function} [callback] optional callback for compatibility with Document.prototype.remove\r\n */\r\n\r\nSubdocument.prototype.remove = function(options, callback) {\r\n  if (typeof options === 'function') {\r\n    callback = options;\r\n    options = null;\r\n  }\r\n  registerRemoveListener(this);\r\n\r\n  // If removing entire doc, no need to remove subdoc\r\n  if (!options || !options.noop) {\r\n    this.$__removeFromParent();\r\n  }\r\n\r\n  return this.$__remove(callback);\r\n};\r\n\r\n/*!\r\n * ignore\r\n */\r\n\r\nSubdocument.prototype.populate = function() {\r\n  throw new Error('Mongoose does not support calling populate() on nested ' +\r\n    'docs. Instead of `doc.nested.populate(\"path\")`, use ' +\r\n    '`doc.populate(\"nested.path\")`');\r\n};\r\n\r\n/**\r\n * Helper for console.log\r\n *\r\n * @api public\r\n */\r\n\r\nSubdocument.prototype.inspect = function() {\r\n  return this.toObject({\r\n    transform: false,\r\n    virtuals: false,\r\n    flattenDecimals: false\r\n  });\r\n};\r\n\r\nif (util.inspect.custom) {\r\n  // Avoid Node deprecation warning DEP0079\r\n  Subdocument.prototype[util.inspect.custom] = Subdocument.prototype.inspect;\r\n}\r\n\r\n/**\r\n * Registers remove event listeners for triggering\r\n * on subdocuments.\r\n *\r\n * @param {Subdocument} sub\r\n * @api private\r\n */\r\n\r\nfunction registerRemoveListener(sub) {\r\n  let owner = sub.ownerDocument();\r\n\r\n  function emitRemove() {\r\n    owner.$removeListener('save', emitRemove);\r\n    owner.$removeListener('remove', emitRemove);\r\n    sub.emit('remove', sub);\r\n    sub.constructor.emit('remove', sub);\r\n    owner = sub = null;\r\n  }\r\n\r\n  owner.$on('save', emitRemove);\r\n  owner.$on('remove', emitRemove);\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}