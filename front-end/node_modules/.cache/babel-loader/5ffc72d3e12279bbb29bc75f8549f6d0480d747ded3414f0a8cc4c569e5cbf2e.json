{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Collection = void 0;\nconst bson_1 = require(\"./bson\");\nconst ordered_1 = require(\"./bulk/ordered\");\nconst unordered_1 = require(\"./bulk/unordered\");\nconst change_stream_1 = require(\"./change_stream\");\nconst aggregation_cursor_1 = require(\"./cursor/aggregation_cursor\");\nconst find_cursor_1 = require(\"./cursor/find_cursor\");\nconst list_indexes_cursor_1 = require(\"./cursor/list_indexes_cursor\");\nconst error_1 = require(\"./error\");\nconst bulk_write_1 = require(\"./operations/bulk_write\");\nconst count_1 = require(\"./operations/count\");\nconst count_documents_1 = require(\"./operations/count_documents\");\nconst delete_1 = require(\"./operations/delete\");\nconst distinct_1 = require(\"./operations/distinct\");\nconst drop_1 = require(\"./operations/drop\");\nconst estimated_document_count_1 = require(\"./operations/estimated_document_count\");\nconst execute_operation_1 = require(\"./operations/execute_operation\");\nconst find_and_modify_1 = require(\"./operations/find_and_modify\");\nconst indexes_1 = require(\"./operations/indexes\");\nconst insert_1 = require(\"./operations/insert\");\nconst is_capped_1 = require(\"./operations/is_capped\");\nconst map_reduce_1 = require(\"./operations/map_reduce\");\nconst options_operation_1 = require(\"./operations/options_operation\");\nconst rename_1 = require(\"./operations/rename\");\nconst stats_1 = require(\"./operations/stats\");\nconst update_1 = require(\"./operations/update\");\nconst read_concern_1 = require(\"./read_concern\");\nconst read_preference_1 = require(\"./read_preference\");\nconst utils_1 = require(\"./utils\");\nconst write_concern_1 = require(\"./write_concern\");\n/**\r\n * The **Collection** class is an internal class that embodies a MongoDB collection\r\n * allowing for insert/find/update/delete and other command operation on that MongoDB collection.\r\n *\r\n * **COLLECTION Cannot directly be instantiated**\r\n * @public\r\n *\r\n * @example\r\n * ```ts\r\n * import { MongoClient } from 'mongodb';\r\n *\r\n * interface Pet {\r\n *   name: string;\r\n *   kind: 'dog' | 'cat' | 'fish';\r\n * }\r\n *\r\n * const client = new MongoClient('mongodb://localhost:27017');\r\n * const pets = client.db().collection<Pet>('pets');\r\n *\r\n * const petCursor = pets.find();\r\n *\r\n * for await (const pet of petCursor) {\r\n *   console.log(`${pet.name} is a ${pet.kind}!`);\r\n * }\r\n * ```\r\n */\nclass Collection {\n  /**\r\n   * Create a new Collection instance\r\n   * @internal\r\n   */\n  constructor(db, name, options) {\n    var _a, _b;\n    (0, utils_1.checkCollectionName)(name);\n    // Internal state\n    this.s = {\n      db,\n      options,\n      namespace: new utils_1.MongoDBNamespace(db.databaseName, name),\n      pkFactory: (_b = (_a = db.options) === null || _a === void 0 ? void 0 : _a.pkFactory) !== null && _b !== void 0 ? _b : utils_1.DEFAULT_PK_FACTORY,\n      readPreference: read_preference_1.ReadPreference.fromOptions(options),\n      bsonOptions: (0, bson_1.resolveBSONOptions)(options, db),\n      readConcern: read_concern_1.ReadConcern.fromOptions(options),\n      writeConcern: write_concern_1.WriteConcern.fromOptions(options)\n    };\n  }\n  /**\r\n   * The name of the database this collection belongs to\r\n   */\n  get dbName() {\n    return this.s.namespace.db;\n  }\n  /**\r\n   * The name of this collection\r\n   */\n  get collectionName() {\n    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n    return this.s.namespace.collection;\n  }\n  /**\r\n   * The namespace of this collection, in the format `${this.dbName}.${this.collectionName}`\r\n   */\n  get namespace() {\n    return this.s.namespace.toString();\n  }\n  /**\r\n   * The current readConcern of the collection. If not explicitly defined for\r\n   * this collection, will be inherited from the parent DB\r\n   */\n  get readConcern() {\n    if (this.s.readConcern == null) {\n      return this.s.db.readConcern;\n    }\n    return this.s.readConcern;\n  }\n  /**\r\n   * The current readPreference of the collection. If not explicitly defined for\r\n   * this collection, will be inherited from the parent DB\r\n   */\n  get readPreference() {\n    if (this.s.readPreference == null) {\n      return this.s.db.readPreference;\n    }\n    return this.s.readPreference;\n  }\n  get bsonOptions() {\n    return this.s.bsonOptions;\n  }\n  /**\r\n   * The current writeConcern of the collection. If not explicitly defined for\r\n   * this collection, will be inherited from the parent DB\r\n   */\n  get writeConcern() {\n    if (this.s.writeConcern == null) {\n      return this.s.db.writeConcern;\n    }\n    return this.s.writeConcern;\n  }\n  /** The current index hint for the collection */\n  get hint() {\n    return this.s.collectionHint;\n  }\n  set hint(v) {\n    this.s.collectionHint = (0, utils_1.normalizeHintField)(v);\n  }\n  insertOne(doc, options, callback) {\n    if (typeof options === 'function') {\n      callback = options;\n      options = {};\n    }\n    // versions of mongodb-client-encryption before v1.2.6 pass in hardcoded { w: 'majority' }\n    // specifically to an insertOne call in createDataKey, so we want to support this only here\n    if (options && Reflect.get(options, 'w')) {\n      options.writeConcern = write_concern_1.WriteConcern.fromOptions(Reflect.get(options, 'w'));\n    }\n    return (0, execute_operation_1.executeOperation)(this.s.db.s.client, new insert_1.InsertOneOperation(this, doc, (0, utils_1.resolveOptions)(this, options)), callback);\n  }\n  insertMany(docs, options, callback) {\n    if (typeof options === 'function') callback = options, options = {};\n    options = options ? Object.assign({}, options) : {\n      ordered: true\n    };\n    return (0, execute_operation_1.executeOperation)(this.s.db.s.client, new insert_1.InsertManyOperation(this, docs, (0, utils_1.resolveOptions)(this, options)), callback);\n  }\n  bulkWrite(operations, options, callback) {\n    if (typeof options === 'function') callback = options, options = {};\n    options = options || {\n      ordered: true\n    };\n    if (!Array.isArray(operations)) {\n      throw new error_1.MongoInvalidArgumentError('Argument \"operations\" must be an array of documents');\n    }\n    return (0, execute_operation_1.executeOperation)(this.s.db.s.client, new bulk_write_1.BulkWriteOperation(this, operations, (0, utils_1.resolveOptions)(this, options)), callback);\n  }\n  updateOne(filter, update, options, callback) {\n    if (typeof options === 'function') callback = options, options = {};\n    return (0, execute_operation_1.executeOperation)(this.s.db.s.client, new update_1.UpdateOneOperation(this, filter, update, (0, utils_1.resolveOptions)(this, options)), callback);\n  }\n  replaceOne(filter, replacement, options, callback) {\n    if (typeof options === 'function') callback = options, options = {};\n    return (0, execute_operation_1.executeOperation)(this.s.db.s.client, new update_1.ReplaceOneOperation(this, filter, replacement, (0, utils_1.resolveOptions)(this, options)), callback);\n  }\n  updateMany(filter, update, options, callback) {\n    if (typeof options === 'function') callback = options, options = {};\n    return (0, execute_operation_1.executeOperation)(this.s.db.s.client, new update_1.UpdateManyOperation(this, filter, update, (0, utils_1.resolveOptions)(this, options)), callback);\n  }\n  deleteOne(filter, options, callback) {\n    if (typeof options === 'function') callback = options, options = {};\n    return (0, execute_operation_1.executeOperation)(this.s.db.s.client, new delete_1.DeleteOneOperation(this, filter, (0, utils_1.resolveOptions)(this, options)), callback);\n  }\n  deleteMany(filter, options, callback) {\n    if (filter == null) {\n      filter = {};\n      options = {};\n      callback = undefined;\n    } else if (typeof filter === 'function') {\n      callback = filter;\n      filter = {};\n      options = {};\n    } else if (typeof options === 'function') {\n      callback = options;\n      options = {};\n    }\n    return (0, execute_operation_1.executeOperation)(this.s.db.s.client, new delete_1.DeleteManyOperation(this, filter, (0, utils_1.resolveOptions)(this, options)), callback);\n  }\n  rename(newName, options, callback) {\n    if (typeof options === 'function') callback = options, options = {};\n    // Intentionally, we do not inherit options from parent for this operation.\n    return (0, execute_operation_1.executeOperation)(this.s.db.s.client, new rename_1.RenameOperation(this, newName, {\n      ...options,\n      readPreference: read_preference_1.ReadPreference.PRIMARY\n    }), callback);\n  }\n  drop(options, callback) {\n    if (typeof options === 'function') callback = options, options = {};\n    options = options !== null && options !== void 0 ? options : {};\n    return (0, execute_operation_1.executeOperation)(this.s.db.s.client, new drop_1.DropCollectionOperation(this.s.db, this.collectionName, options), callback);\n  }\n  findOne(filter, options, callback) {\n    if (callback != null && typeof callback !== 'function') {\n      throw new error_1.MongoInvalidArgumentError('Third parameter to `findOne()` must be a callback or undefined');\n    }\n    if (typeof filter === 'function') {\n      callback = filter;\n      filter = {};\n      options = {};\n    }\n    if (typeof options === 'function') {\n      callback = options;\n      options = {};\n    }\n    const finalFilter = filter !== null && filter !== void 0 ? filter : {};\n    const finalOptions = options !== null && options !== void 0 ? options : {};\n    return this.find(finalFilter, finalOptions).limit(-1).batchSize(1).next(callback);\n  }\n  find(filter, options) {\n    if (arguments.length > 2) {\n      throw new error_1.MongoInvalidArgumentError('Method \"collection.find()\" accepts at most two arguments');\n    }\n    if (typeof options === 'function') {\n      throw new error_1.MongoInvalidArgumentError('Argument \"options\" must not be function');\n    }\n    return new find_cursor_1.FindCursor(this.s.db.s.client, this.s.namespace, filter, (0, utils_1.resolveOptions)(this, options));\n  }\n  options(options, callback) {\n    if (typeof options === 'function') callback = options, options = {};\n    return (0, execute_operation_1.executeOperation)(this.s.db.s.client, new options_operation_1.OptionsOperation(this, (0, utils_1.resolveOptions)(this, options)), callback);\n  }\n  isCapped(options, callback) {\n    if (typeof options === 'function') callback = options, options = {};\n    return (0, execute_operation_1.executeOperation)(this.s.db.s.client, new is_capped_1.IsCappedOperation(this, (0, utils_1.resolveOptions)(this, options)), callback);\n  }\n  createIndex(indexSpec, options, callback) {\n    if (typeof options === 'function') callback = options, options = {};\n    return (0, execute_operation_1.executeOperation)(this.s.db.s.client, new indexes_1.CreateIndexOperation(this, this.collectionName, indexSpec, (0, utils_1.resolveOptions)(this, options)), callback);\n  }\n  createIndexes(indexSpecs, options, callback) {\n    if (typeof options === 'function') callback = options, options = {};\n    options = options ? Object.assign({}, options) : {};\n    if (typeof options.maxTimeMS !== 'number') delete options.maxTimeMS;\n    return (0, execute_operation_1.executeOperation)(this.s.db.s.client, new indexes_1.CreateIndexesOperation(this, this.collectionName, indexSpecs, (0, utils_1.resolveOptions)(this, options)), callback);\n  }\n  dropIndex(indexName, options, callback) {\n    if (typeof options === 'function') callback = options, options = {};\n    options = (0, utils_1.resolveOptions)(this, options);\n    // Run only against primary\n    options.readPreference = read_preference_1.ReadPreference.primary;\n    return (0, execute_operation_1.executeOperation)(this.s.db.s.client, new indexes_1.DropIndexOperation(this, indexName, options), callback);\n  }\n  dropIndexes(options, callback) {\n    if (typeof options === 'function') callback = options, options = {};\n    return (0, execute_operation_1.executeOperation)(this.s.db.s.client, new indexes_1.DropIndexesOperation(this, (0, utils_1.resolveOptions)(this, options)), callback);\n  }\n  /**\r\n   * Get the list of all indexes information for the collection.\r\n   *\r\n   * @param options - Optional settings for the command\r\n   */\n  listIndexes(options) {\n    return new list_indexes_cursor_1.ListIndexesCursor(this, (0, utils_1.resolveOptions)(this, options));\n  }\n  indexExists(indexes, options, callback) {\n    if (typeof options === 'function') callback = options, options = {};\n    return (0, execute_operation_1.executeOperation)(this.s.db.s.client, new indexes_1.IndexExistsOperation(this, indexes, (0, utils_1.resolveOptions)(this, options)), callback);\n  }\n  indexInformation(options, callback) {\n    if (typeof options === 'function') callback = options, options = {};\n    return (0, execute_operation_1.executeOperation)(this.s.db.s.client, new indexes_1.IndexInformationOperation(this.s.db, this.collectionName, (0, utils_1.resolveOptions)(this, options)), callback);\n  }\n  estimatedDocumentCount(options, callback) {\n    if (typeof options === 'function') callback = options, options = {};\n    return (0, execute_operation_1.executeOperation)(this.s.db.s.client, new estimated_document_count_1.EstimatedDocumentCountOperation(this, (0, utils_1.resolveOptions)(this, options)), callback);\n  }\n  countDocuments(filter, options, callback) {\n    if (filter == null) {\n      filter = {}, options = {}, callback = undefined;\n    } else if (typeof filter === 'function') {\n      callback = filter, filter = {}, options = {};\n    } else {\n      if (arguments.length === 2) {\n        if (typeof options === 'function') callback = options, options = {};\n      }\n    }\n    filter !== null && filter !== void 0 ? filter : filter = {};\n    return (0, execute_operation_1.executeOperation)(this.s.db.s.client, new count_documents_1.CountDocumentsOperation(this, filter, (0, utils_1.resolveOptions)(this, options)), callback);\n  }\n  // Implementation\n  distinct(key, filter, options, callback) {\n    if (typeof filter === 'function') {\n      callback = filter, filter = {}, options = {};\n    } else {\n      if (arguments.length === 3 && typeof options === 'function') {\n        callback = options, options = {};\n      }\n    }\n    filter !== null && filter !== void 0 ? filter : filter = {};\n    return (0, execute_operation_1.executeOperation)(this.s.db.s.client, new distinct_1.DistinctOperation(this, key, filter, (0, utils_1.resolveOptions)(this, options)), callback);\n  }\n  indexes(options, callback) {\n    if (typeof options === 'function') callback = options, options = {};\n    return (0, execute_operation_1.executeOperation)(this.s.db.s.client, new indexes_1.IndexesOperation(this, (0, utils_1.resolveOptions)(this, options)), callback);\n  }\n  stats(options, callback) {\n    if (typeof options === 'function') callback = options, options = {};\n    options = options !== null && options !== void 0 ? options : {};\n    return (0, execute_operation_1.executeOperation)(this.s.db.s.client, new stats_1.CollStatsOperation(this, options), callback);\n  }\n  findOneAndDelete(filter, options, callback) {\n    if (typeof options === 'function') callback = options, options = {};\n    return (0, execute_operation_1.executeOperation)(this.s.db.s.client, new find_and_modify_1.FindOneAndDeleteOperation(this, filter, (0, utils_1.resolveOptions)(this, options)), callback);\n  }\n  findOneAndReplace(filter, replacement, options, callback) {\n    if (typeof options === 'function') callback = options, options = {};\n    return (0, execute_operation_1.executeOperation)(this.s.db.s.client, new find_and_modify_1.FindOneAndReplaceOperation(this, filter, replacement, (0, utils_1.resolveOptions)(this, options)), callback);\n  }\n  findOneAndUpdate(filter, update, options, callback) {\n    if (typeof options === 'function') callback = options, options = {};\n    return (0, execute_operation_1.executeOperation)(this.s.db.s.client, new find_and_modify_1.FindOneAndUpdateOperation(this, filter, update, (0, utils_1.resolveOptions)(this, options)), callback);\n  }\n  /**\r\n   * Execute an aggregation framework pipeline against the collection, needs MongoDB \\>= 2.2\r\n   *\r\n   * @param pipeline - An array of aggregation pipelines to execute\r\n   * @param options - Optional settings for the command\r\n   */\n  aggregate() {\n    let pipeline = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n    let options = arguments.length > 1 ? arguments[1] : undefined;\n    if (arguments.length > 2) {\n      throw new error_1.MongoInvalidArgumentError('Method \"collection.aggregate()\" accepts at most two arguments');\n    }\n    if (!Array.isArray(pipeline)) {\n      throw new error_1.MongoInvalidArgumentError('Argument \"pipeline\" must be an array of aggregation stages');\n    }\n    if (typeof options === 'function') {\n      throw new error_1.MongoInvalidArgumentError('Argument \"options\" must not be function');\n    }\n    return new aggregation_cursor_1.AggregationCursor(this.s.db.s.client, this.s.namespace, pipeline, (0, utils_1.resolveOptions)(this, options));\n  }\n  /**\r\n   * Create a new Change Stream, watching for new changes (insertions, updates, replacements, deletions, and invalidations) in this collection.\r\n   *\r\n   * @remarks\r\n   * watch() accepts two generic arguments for distinct use cases:\r\n   * - The first is to override the schema that may be defined for this specific collection\r\n   * - The second is to override the shape of the change stream document entirely, if it is not provided the type will default to ChangeStreamDocument of the first argument\r\n   * @example\r\n   * By just providing the first argument I can type the change to be `ChangeStreamDocument<{ _id: number }>`\r\n   * ```ts\r\n   * collection.watch<{ _id: number }>()\r\n   *   .on('change', change => console.log(change._id.toFixed(4)));\r\n   * ```\r\n   *\r\n   * @example\r\n   * Passing a second argument provides a way to reflect the type changes caused by an advanced pipeline.\r\n   * Here, we are using a pipeline to have MongoDB filter for insert changes only and add a comment.\r\n   * No need start from scratch on the ChangeStreamInsertDocument type!\r\n   * By using an intersection we can save time and ensure defaults remain the same type!\r\n   * ```ts\r\n   * collection\r\n   *   .watch<Schema, ChangeStreamInsertDocument<Schema> & { comment: string }>([\r\n   *     { $addFields: { comment: 'big changes' } },\r\n   *     { $match: { operationType: 'insert' } }\r\n   *   ])\r\n   *   .on('change', change => {\r\n   *     change.comment.startsWith('big');\r\n   *     change.operationType === 'insert';\r\n   *     // No need to narrow in code because the generics did that for us!\r\n   *     expectType<Schema>(change.fullDocument);\r\n   *   });\r\n   * ```\r\n   *\r\n   * @param pipeline - An array of {@link https://docs.mongodb.com/manual/reference/operator/aggregation-pipeline/|aggregation pipeline stages} through which to pass change stream documents. This allows for filtering (using $match) and manipulating the change stream documents.\r\n   * @param options - Optional settings for the command\r\n   * @typeParam TLocal - Type of the data being detected by the change stream\r\n   * @typeParam TChange - Type of the whole change stream document emitted\r\n   */\n  watch() {\n    let pipeline = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n    let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    // Allow optionally not specifying a pipeline\n    if (!Array.isArray(pipeline)) {\n      options = pipeline;\n      pipeline = [];\n    }\n    return new change_stream_1.ChangeStream(this, pipeline, (0, utils_1.resolveOptions)(this, options));\n  }\n  mapReduce(map, reduce, options, callback) {\n    (0, utils_1.emitWarningOnce)('collection.mapReduce is deprecated. Use the aggregation pipeline instead. Visit https://docs.mongodb.com/manual/reference/map-reduce-to-aggregation-pipeline for more information on how to translate map-reduce operations to the aggregation pipeline.');\n    if ('function' === typeof options) callback = options, options = {};\n    // Out must always be defined (make sure we don't break weirdly on pre 1.8+ servers)\n    // TODO NODE-3339: Figure out if this is still necessary given we no longer officially support pre-1.8\n    if ((options === null || options === void 0 ? void 0 : options.out) == null) {\n      throw new error_1.MongoInvalidArgumentError('Option \"out\" must be defined, see mongodb docs for possible values');\n    }\n    if ('function' === typeof map) {\n      map = map.toString();\n    }\n    if ('function' === typeof reduce) {\n      reduce = reduce.toString();\n    }\n    if ('function' === typeof options.finalize) {\n      options.finalize = options.finalize.toString();\n    }\n    return (0, execute_operation_1.executeOperation)(this.s.db.s.client, new map_reduce_1.MapReduceOperation(this, map, reduce, (0, utils_1.resolveOptions)(this, options)), callback);\n  }\n  /**\r\n   * Initiate an Out of order batch write operation. All operations will be buffered into insert/update/remove commands executed out of order.\r\n   *\r\n   * @throws MongoNotConnectedError\r\n   * @remarks\r\n   * **NOTE:** MongoClient must be connected prior to calling this method due to a known limitation in this legacy implementation.\r\n   * However, `collection.bulkWrite()` provides an equivalent API that does not require prior connecting.\r\n   */\n  initializeUnorderedBulkOp(options) {\n    return new unordered_1.UnorderedBulkOperation(this, (0, utils_1.resolveOptions)(this, options));\n  }\n  /**\r\n   * Initiate an In order bulk write operation. Operations will be serially executed in the order they are added, creating a new operation for each switch in types.\r\n   *\r\n   * @throws MongoNotConnectedError\r\n   * @remarks\r\n   * **NOTE:** MongoClient must be connected prior to calling this method due to a known limitation in this legacy implementation.\r\n   * However, `collection.bulkWrite()` provides an equivalent API that does not require prior connecting.\r\n   */\n  initializeOrderedBulkOp(options) {\n    return new ordered_1.OrderedBulkOperation(this, (0, utils_1.resolveOptions)(this, options));\n  }\n  /** Get the db scoped logger */\n  getLogger() {\n    return this.s.db.s.logger;\n  }\n  get logger() {\n    return this.s.db.s.logger;\n  }\n  /**\r\n   * Inserts a single document or a an array of documents into MongoDB. If documents passed in do not contain the **_id** field,\r\n   * one will be added to each of the documents missing it by the driver, mutating the document. This behavior\r\n   * can be overridden by setting the **forceServerObjectId** flag.\r\n   *\r\n   * @deprecated Use insertOne, insertMany or bulkWrite instead. Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance\r\n   * @param docs - The documents to insert\r\n   * @param options - Optional settings for the command\r\n   * @param callback - An optional callback, a Promise will be returned if none is provided\r\n   */\n  insert(docs, options, callback) {\n    (0, utils_1.emitWarningOnce)('collection.insert is deprecated. Use insertOne, insertMany or bulkWrite instead.');\n    if (typeof options === 'function') callback = options, options = {};\n    options = options || {\n      ordered: false\n    };\n    docs = !Array.isArray(docs) ? [docs] : docs;\n    if (options.keepGoing === true) {\n      options.ordered = false;\n    }\n    return this.insertMany(docs, options, callback);\n  }\n  /**\r\n   * Updates documents.\r\n   *\r\n   * @deprecated use updateOne, updateMany or bulkWrite. Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance\r\n   * @param filter - The filter for the update operation.\r\n   * @param update - The update operations to be applied to the documents\r\n   * @param options - Optional settings for the command\r\n   * @param callback - An optional callback, a Promise will be returned if none is provided\r\n   */\n  update(filter, update, options, callback) {\n    (0, utils_1.emitWarningOnce)('collection.update is deprecated. Use updateOne, updateMany, or bulkWrite instead.');\n    if (typeof options === 'function') callback = options, options = {};\n    options = options !== null && options !== void 0 ? options : {};\n    return this.updateMany(filter, update, options, callback);\n  }\n  /**\r\n   * Remove documents.\r\n   *\r\n   * @deprecated use deleteOne, deleteMany or bulkWrite. Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance\r\n   * @param filter - The filter for the remove operation.\r\n   * @param options - Optional settings for the command\r\n   * @param callback - An optional callback, a Promise will be returned if none is provided\r\n   */\n  remove(filter, options, callback) {\n    (0, utils_1.emitWarningOnce)('collection.remove is deprecated. Use deleteOne, deleteMany, or bulkWrite instead.');\n    if (typeof options === 'function') callback = options, options = {};\n    options = options !== null && options !== void 0 ? options : {};\n    return this.deleteMany(filter, options, callback);\n  }\n  count(filter, options, callback) {\n    if (typeof filter === 'function') {\n      callback = filter, filter = {}, options = {};\n    } else {\n      if (typeof options === 'function') callback = options, options = {};\n    }\n    filter !== null && filter !== void 0 ? filter : filter = {};\n    return (0, execute_operation_1.executeOperation)(this.s.db.s.client, new count_1.CountOperation(utils_1.MongoDBNamespace.fromString(this.namespace), filter, (0, utils_1.resolveOptions)(this, options)), callback);\n  }\n}\nexports.Collection = Collection;","map":{"version":3,"mappings":"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","names":["Collection","constructor","db","name","options","s","namespace","utils_1","databaseName","pkFactory","readPreference","read_preference_1","fromOptions","bsonOptions","readConcern","read_concern_1","writeConcern","write_concern_1","dbName","collectionName","collection","toString","hint","collectionHint","v","insertOne","doc","callback","Reflect","get","client","insert_1","insertMany","docs","Object","assign","ordered","bulkWrite","operations","Array","isArray","error_1","bulk_write_1","updateOne","filter","update","update_1","replaceOne","replacement","updateMany","deleteOne","delete_1","deleteMany","undefined","rename","newName","rename_1","PRIMARY","drop","drop_1","findOne","finalFilter","finalOptions","find","limit","batchSize","next","arguments","length","find_cursor_1","options_operation_1","isCapped","is_capped_1","createIndex","indexSpec","indexes_1","createIndexes","indexSpecs","maxTimeMS","dropIndex","indexName","primary","dropIndexes","listIndexes","list_indexes_cursor_1","indexExists","indexes","indexInformation","estimatedDocumentCount","estimated_document_count_1","countDocuments","count_documents_1","distinct","key","distinct_1","stats","stats_1","findOneAndDelete","find_and_modify_1","findOneAndReplace","findOneAndUpdate","aggregate","pipeline","aggregation_cursor_1","watch","change_stream_1","mapReduce","map","reduce","out","finalize","map_reduce_1","initializeUnorderedBulkOp","unordered_1","initializeOrderedBulkOp","ordered_1","getLogger","logger","insert","keepGoing","remove","count","count_1","fromString","exports"],"sources":["C:\\Users\\91930\\Desktop\\Github projects\\Pharmacy Demo\\back-end\\node_modules\\mongodb\\src\\collection.ts"],"sourcesContent":["import { BSONSerializeOptions, Document, resolveBSONOptions } from './bson';\r\nimport type { AnyBulkWriteOperation, BulkWriteOptions, BulkWriteResult } from './bulk/common';\r\nimport { OrderedBulkOperation } from './bulk/ordered';\r\nimport { UnorderedBulkOperation } from './bulk/unordered';\r\nimport { ChangeStream, ChangeStreamDocument, ChangeStreamOptions } from './change_stream';\r\nimport { AggregationCursor } from './cursor/aggregation_cursor';\r\nimport { FindCursor } from './cursor/find_cursor';\r\nimport { ListIndexesCursor } from './cursor/list_indexes_cursor';\r\nimport type { Db } from './db';\r\nimport { MongoInvalidArgumentError } from './error';\r\nimport type { Logger, LoggerOptions } from './logger';\r\nimport type { PkFactory } from './mongo_client';\r\nimport type {\r\n  Filter,\r\n  Flatten,\r\n  OptionalUnlessRequiredId,\r\n  TODO_NODE_3286,\r\n  UpdateFilter,\r\n  WithId,\r\n  WithoutId\r\n} from './mongo_types';\r\nimport type { AggregateOptions } from './operations/aggregate';\r\nimport { BulkWriteOperation } from './operations/bulk_write';\r\nimport type { IndexInformationOptions } from './operations/common_functions';\r\nimport { CountOperation, CountOptions } from './operations/count';\r\nimport { CountDocumentsOperation, CountDocumentsOptions } from './operations/count_documents';\r\nimport {\r\n  DeleteManyOperation,\r\n  DeleteOneOperation,\r\n  DeleteOptions,\r\n  DeleteResult\r\n} from './operations/delete';\r\nimport { DistinctOperation, DistinctOptions } from './operations/distinct';\r\nimport { DropCollectionOperation, DropCollectionOptions } from './operations/drop';\r\nimport {\r\n  EstimatedDocumentCountOperation,\r\n  EstimatedDocumentCountOptions\r\n} from './operations/estimated_document_count';\r\nimport { executeOperation } from './operations/execute_operation';\r\nimport type { FindOptions } from './operations/find';\r\nimport {\r\n  FindOneAndDeleteOperation,\r\n  FindOneAndDeleteOptions,\r\n  FindOneAndReplaceOperation,\r\n  FindOneAndReplaceOptions,\r\n  FindOneAndUpdateOperation,\r\n  FindOneAndUpdateOptions\r\n} from './operations/find_and_modify';\r\nimport {\r\n  CreateIndexesOperation,\r\n  CreateIndexesOptions,\r\n  CreateIndexOperation,\r\n  DropIndexesOperation,\r\n  DropIndexesOptions,\r\n  DropIndexOperation,\r\n  IndexDescription,\r\n  IndexesOperation,\r\n  IndexExistsOperation,\r\n  IndexInformationOperation,\r\n  IndexSpecification,\r\n  ListIndexesOptions\r\n} from './operations/indexes';\r\nimport {\r\n  InsertManyOperation,\r\n  InsertManyResult,\r\n  InsertOneOperation,\r\n  InsertOneOptions,\r\n  InsertOneResult\r\n} from './operations/insert';\r\nimport { IsCappedOperation } from './operations/is_capped';\r\nimport {\r\n  MapFunction,\r\n  MapReduceOperation,\r\n  MapReduceOptions,\r\n  ReduceFunction\r\n} from './operations/map_reduce';\r\nimport type { Hint, OperationOptions } from './operations/operation';\r\nimport { OptionsOperation } from './operations/options_operation';\r\nimport { RenameOperation, RenameOptions } from './operations/rename';\r\nimport { CollStats, CollStatsOperation, CollStatsOptions } from './operations/stats';\r\nimport {\r\n  ReplaceOneOperation,\r\n  ReplaceOptions,\r\n  UpdateManyOperation,\r\n  UpdateOneOperation,\r\n  UpdateOptions,\r\n  UpdateResult\r\n} from './operations/update';\r\nimport { ReadConcern, ReadConcernLike } from './read_concern';\r\nimport { ReadPreference, ReadPreferenceLike } from './read_preference';\r\nimport {\r\n  Callback,\r\n  checkCollectionName,\r\n  DEFAULT_PK_FACTORY,\r\n  emitWarningOnce,\r\n  MongoDBNamespace,\r\n  normalizeHintField,\r\n  resolveOptions\r\n} from './utils';\r\nimport { WriteConcern, WriteConcernOptions } from './write_concern';\r\n\r\n/**\r\n * @public\r\n * @deprecated This type will be completely removed in 5.0 and findOneAndUpdate,\r\n *             findOneAndDelete, and findOneAndReplace will then return the\r\n *             actual result document.\r\n */\r\nexport interface ModifyResult<TSchema = Document> {\r\n  value: WithId<TSchema> | null;\r\n  lastErrorObject?: Document;\r\n  ok: 0 | 1;\r\n}\r\n\r\n/** @public */\r\nexport interface CollectionOptions\r\n  extends BSONSerializeOptions,\r\n    WriteConcernOptions,\r\n    LoggerOptions {\r\n  /**\r\n   * @deprecated Use readPreference instead\r\n   */\r\n  slaveOk?: boolean;\r\n  /** Specify a read concern for the collection. (only MongoDB 3.2 or higher supported) */\r\n  readConcern?: ReadConcernLike;\r\n  /** The preferred read preference (ReadPreference.PRIMARY, ReadPreference.PRIMARY_PREFERRED, ReadPreference.SECONDARY, ReadPreference.SECONDARY_PREFERRED, ReadPreference.NEAREST). */\r\n  readPreference?: ReadPreferenceLike;\r\n}\r\n\r\n/** @internal */\r\nexport interface CollectionPrivate {\r\n  pkFactory: PkFactory;\r\n  db: Db;\r\n  options: any;\r\n  namespace: MongoDBNamespace;\r\n  readPreference?: ReadPreference;\r\n  bsonOptions: BSONSerializeOptions;\r\n  collectionHint?: Hint;\r\n  readConcern?: ReadConcern;\r\n  writeConcern?: WriteConcern;\r\n}\r\n\r\n/**\r\n * The **Collection** class is an internal class that embodies a MongoDB collection\r\n * allowing for insert/find/update/delete and other command operation on that MongoDB collection.\r\n *\r\n * **COLLECTION Cannot directly be instantiated**\r\n * @public\r\n *\r\n * @example\r\n * ```ts\r\n * import { MongoClient } from 'mongodb';\r\n *\r\n * interface Pet {\r\n *   name: string;\r\n *   kind: 'dog' | 'cat' | 'fish';\r\n * }\r\n *\r\n * const client = new MongoClient('mongodb://localhost:27017');\r\n * const pets = client.db().collection<Pet>('pets');\r\n *\r\n * const petCursor = pets.find();\r\n *\r\n * for await (const pet of petCursor) {\r\n *   console.log(`${pet.name} is a ${pet.kind}!`);\r\n * }\r\n * ```\r\n */\r\nexport class Collection<TSchema extends Document = Document> {\r\n  /** @internal */\r\n  s: CollectionPrivate;\r\n\r\n  /**\r\n   * Create a new Collection instance\r\n   * @internal\r\n   */\r\n  constructor(db: Db, name: string, options?: CollectionOptions) {\r\n    checkCollectionName(name);\r\n\r\n    // Internal state\r\n    this.s = {\r\n      db,\r\n      options,\r\n      namespace: new MongoDBNamespace(db.databaseName, name),\r\n      pkFactory: db.options?.pkFactory ?? DEFAULT_PK_FACTORY,\r\n      readPreference: ReadPreference.fromOptions(options),\r\n      bsonOptions: resolveBSONOptions(options, db),\r\n      readConcern: ReadConcern.fromOptions(options),\r\n      writeConcern: WriteConcern.fromOptions(options)\r\n    };\r\n  }\r\n\r\n  /**\r\n   * The name of the database this collection belongs to\r\n   */\r\n  get dbName(): string {\r\n    return this.s.namespace.db;\r\n  }\r\n\r\n  /**\r\n   * The name of this collection\r\n   */\r\n  get collectionName(): string {\r\n    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\r\n    return this.s.namespace.collection!;\r\n  }\r\n\r\n  /**\r\n   * The namespace of this collection, in the format `${this.dbName}.${this.collectionName}`\r\n   */\r\n  get namespace(): string {\r\n    return this.s.namespace.toString();\r\n  }\r\n\r\n  /**\r\n   * The current readConcern of the collection. If not explicitly defined for\r\n   * this collection, will be inherited from the parent DB\r\n   */\r\n  get readConcern(): ReadConcern | undefined {\r\n    if (this.s.readConcern == null) {\r\n      return this.s.db.readConcern;\r\n    }\r\n    return this.s.readConcern;\r\n  }\r\n\r\n  /**\r\n   * The current readPreference of the collection. If not explicitly defined for\r\n   * this collection, will be inherited from the parent DB\r\n   */\r\n  get readPreference(): ReadPreference | undefined {\r\n    if (this.s.readPreference == null) {\r\n      return this.s.db.readPreference;\r\n    }\r\n\r\n    return this.s.readPreference;\r\n  }\r\n\r\n  get bsonOptions(): BSONSerializeOptions {\r\n    return this.s.bsonOptions;\r\n  }\r\n\r\n  /**\r\n   * The current writeConcern of the collection. If not explicitly defined for\r\n   * this collection, will be inherited from the parent DB\r\n   */\r\n  get writeConcern(): WriteConcern | undefined {\r\n    if (this.s.writeConcern == null) {\r\n      return this.s.db.writeConcern;\r\n    }\r\n    return this.s.writeConcern;\r\n  }\r\n\r\n  /** The current index hint for the collection */\r\n  get hint(): Hint | undefined {\r\n    return this.s.collectionHint;\r\n  }\r\n\r\n  set hint(v: Hint | undefined) {\r\n    this.s.collectionHint = normalizeHintField(v);\r\n  }\r\n\r\n  /**\r\n   * Inserts a single document into MongoDB. If documents passed in do not contain the **_id** field,\r\n   * one will be added to each of the documents missing it by the driver, mutating the document. This behavior\r\n   * can be overridden by setting the **forceServerObjectId** flag.\r\n   *\r\n   * @param doc - The document to insert\r\n   * @param options - Optional settings for the command\r\n   * @param callback - An optional callback, a Promise will be returned if none is provided\r\n   */\r\n  insertOne(doc: OptionalUnlessRequiredId<TSchema>): Promise<InsertOneResult<TSchema>>;\r\n  insertOne(\r\n    doc: OptionalUnlessRequiredId<TSchema>,\r\n    options: InsertOneOptions\r\n  ): Promise<InsertOneResult<TSchema>>;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  insertOne(\r\n    doc: OptionalUnlessRequiredId<TSchema>,\r\n    callback: Callback<InsertOneResult<TSchema>>\r\n  ): void;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  insertOne(\r\n    doc: OptionalUnlessRequiredId<TSchema>,\r\n    options: InsertOneOptions,\r\n    callback: Callback<InsertOneResult<TSchema>>\r\n  ): void;\r\n  insertOne(\r\n    doc: OptionalUnlessRequiredId<TSchema>,\r\n    options?: InsertOneOptions | Callback<InsertOneResult<TSchema>>,\r\n    callback?: Callback<InsertOneResult<TSchema>>\r\n  ): Promise<InsertOneResult<TSchema>> | void {\r\n    if (typeof options === 'function') {\r\n      callback = options;\r\n      options = {};\r\n    }\r\n\r\n    // versions of mongodb-client-encryption before v1.2.6 pass in hardcoded { w: 'majority' }\r\n    // specifically to an insertOne call in createDataKey, so we want to support this only here\r\n    if (options && Reflect.get(options, 'w')) {\r\n      options.writeConcern = WriteConcern.fromOptions(Reflect.get(options, 'w'));\r\n    }\r\n\r\n    return executeOperation(\r\n      this.s.db.s.client,\r\n      new InsertOneOperation(\r\n        this as TODO_NODE_3286,\r\n        doc,\r\n        resolveOptions(this, options)\r\n      ) as TODO_NODE_3286,\r\n      callback\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Inserts an array of documents into MongoDB. If documents passed in do not contain the **_id** field,\r\n   * one will be added to each of the documents missing it by the driver, mutating the document. This behavior\r\n   * can be overridden by setting the **forceServerObjectId** flag.\r\n   *\r\n   * @param docs - The documents to insert\r\n   * @param options - Optional settings for the command\r\n   * @param callback - An optional callback, a Promise will be returned if none is provided\r\n   */\r\n  insertMany(docs: OptionalUnlessRequiredId<TSchema>[]): Promise<InsertManyResult<TSchema>>;\r\n  insertMany(\r\n    docs: OptionalUnlessRequiredId<TSchema>[],\r\n    options: BulkWriteOptions\r\n  ): Promise<InsertManyResult<TSchema>>;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  insertMany(\r\n    docs: OptionalUnlessRequiredId<TSchema>[],\r\n    callback: Callback<InsertManyResult<TSchema>>\r\n  ): void;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  insertMany(\r\n    docs: OptionalUnlessRequiredId<TSchema>[],\r\n    options: BulkWriteOptions,\r\n    callback: Callback<InsertManyResult<TSchema>>\r\n  ): void;\r\n  insertMany(\r\n    docs: OptionalUnlessRequiredId<TSchema>[],\r\n    options?: BulkWriteOptions | Callback<InsertManyResult<TSchema>>,\r\n    callback?: Callback<InsertManyResult<TSchema>>\r\n  ): Promise<InsertManyResult<TSchema>> | void {\r\n    if (typeof options === 'function') (callback = options), (options = {});\r\n    options = options ? Object.assign({}, options) : { ordered: true };\r\n\r\n    return executeOperation(\r\n      this.s.db.s.client,\r\n      new InsertManyOperation(\r\n        this as TODO_NODE_3286,\r\n        docs,\r\n        resolveOptions(this, options)\r\n      ) as TODO_NODE_3286,\r\n      callback\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Perform a bulkWrite operation without a fluent API\r\n   *\r\n   * Legal operation types are\r\n   * - `insertOne`\r\n   * - `replaceOne`\r\n   * - `updateOne`\r\n   * - `updateMany`\r\n   * - `deleteOne`\r\n   * - `deleteMany`\r\n   *\r\n   * Please note that raw operations are no longer accepted as of driver version 4.0.\r\n   *\r\n   * If documents passed in do not contain the **_id** field,\r\n   * one will be added to each of the documents missing it by the driver, mutating the document. This behavior\r\n   * can be overridden by setting the **forceServerObjectId** flag.\r\n   *\r\n   * @param operations - Bulk operations to perform\r\n   * @param options - Optional settings for the command\r\n   * @param callback - An optional callback, a Promise will be returned if none is provided\r\n   * @throws MongoDriverError if operations is not an array\r\n   */\r\n  bulkWrite(operations: AnyBulkWriteOperation<TSchema>[]): Promise<BulkWriteResult>;\r\n  bulkWrite(\r\n    operations: AnyBulkWriteOperation<TSchema>[],\r\n    options: BulkWriteOptions\r\n  ): Promise<BulkWriteResult>;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  bulkWrite(\r\n    operations: AnyBulkWriteOperation<TSchema>[],\r\n    callback: Callback<BulkWriteResult>\r\n  ): void;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  bulkWrite(\r\n    operations: AnyBulkWriteOperation<TSchema>[],\r\n    options: BulkWriteOptions,\r\n    callback: Callback<BulkWriteResult>\r\n  ): void;\r\n  bulkWrite(\r\n    operations: AnyBulkWriteOperation<TSchema>[],\r\n    options?: BulkWriteOptions | Callback<BulkWriteResult>,\r\n    callback?: Callback<BulkWriteResult>\r\n  ): Promise<BulkWriteResult> | void {\r\n    if (typeof options === 'function') (callback = options), (options = {});\r\n    options = options || { ordered: true };\r\n\r\n    if (!Array.isArray(operations)) {\r\n      throw new MongoInvalidArgumentError('Argument \"operations\" must be an array of documents');\r\n    }\r\n\r\n    return executeOperation(\r\n      this.s.db.s.client,\r\n      new BulkWriteOperation(\r\n        this as TODO_NODE_3286,\r\n        operations as TODO_NODE_3286,\r\n        resolveOptions(this, options)\r\n      ),\r\n      callback\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Update a single document in a collection\r\n   *\r\n   * @param filter - The filter used to select the document to update\r\n   * @param update - The update operations to be applied to the document\r\n   * @param options - Optional settings for the command\r\n   * @param callback - An optional callback, a Promise will be returned if none is provided\r\n   */\r\n  updateOne(\r\n    filter: Filter<TSchema>,\r\n    update: UpdateFilter<TSchema> | Partial<TSchema>\r\n  ): Promise<UpdateResult>;\r\n  updateOne(\r\n    filter: Filter<TSchema>,\r\n    update: UpdateFilter<TSchema> | Partial<TSchema>,\r\n    options: UpdateOptions\r\n  ): Promise<UpdateResult>;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  updateOne(\r\n    filter: Filter<TSchema>,\r\n    update: UpdateFilter<TSchema> | Partial<TSchema>,\r\n    callback: Callback<UpdateResult>\r\n  ): void;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  updateOne(\r\n    filter: Filter<TSchema>,\r\n    update: UpdateFilter<TSchema> | Partial<TSchema>,\r\n    options: UpdateOptions,\r\n    callback: Callback<UpdateResult>\r\n  ): void;\r\n  updateOne(\r\n    filter: Filter<TSchema>,\r\n    update: UpdateFilter<TSchema> | Partial<TSchema>,\r\n    options?: UpdateOptions | Callback<UpdateResult>,\r\n    callback?: Callback<UpdateResult>\r\n  ): Promise<UpdateResult> | void {\r\n    if (typeof options === 'function') (callback = options), (options = {});\r\n\r\n    return executeOperation(\r\n      this.s.db.s.client,\r\n      new UpdateOneOperation(\r\n        this as TODO_NODE_3286,\r\n        filter,\r\n        update,\r\n        resolveOptions(this, options)\r\n      ) as TODO_NODE_3286,\r\n      callback\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Replace a document in a collection with another document\r\n   *\r\n   * @param filter - The filter used to select the document to replace\r\n   * @param replacement - The Document that replaces the matching document\r\n   * @param options - Optional settings for the command\r\n   * @param callback - An optional callback, a Promise will be returned if none is provided\r\n   */\r\n  replaceOne(\r\n    filter: Filter<TSchema>,\r\n    replacement: WithoutId<TSchema>\r\n  ): Promise<UpdateResult | Document>;\r\n  replaceOne(\r\n    filter: Filter<TSchema>,\r\n    replacement: WithoutId<TSchema>,\r\n    options: ReplaceOptions\r\n  ): Promise<UpdateResult | Document>;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  replaceOne(\r\n    filter: Filter<TSchema>,\r\n    replacement: WithoutId<TSchema>,\r\n    callback: Callback<UpdateResult | Document>\r\n  ): void;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  replaceOne(\r\n    filter: Filter<TSchema>,\r\n    replacement: WithoutId<TSchema>,\r\n    options: ReplaceOptions,\r\n    callback: Callback<UpdateResult | Document>\r\n  ): void;\r\n  replaceOne(\r\n    filter: Filter<TSchema>,\r\n    replacement: WithoutId<TSchema>,\r\n    options?: ReplaceOptions | Callback<UpdateResult | Document>,\r\n    callback?: Callback<UpdateResult | Document>\r\n  ): Promise<UpdateResult | Document> | void {\r\n    if (typeof options === 'function') (callback = options), (options = {});\r\n\r\n    return executeOperation(\r\n      this.s.db.s.client,\r\n      new ReplaceOneOperation(\r\n        this as TODO_NODE_3286,\r\n        filter,\r\n        replacement,\r\n        resolveOptions(this, options)\r\n      ),\r\n      callback\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Update multiple documents in a collection\r\n   *\r\n   * @param filter - The filter used to select the documents to update\r\n   * @param update - The update operations to be applied to the documents\r\n   * @param options - Optional settings for the command\r\n   * @param callback - An optional callback, a Promise will be returned if none is provided\r\n   */\r\n  updateMany(\r\n    filter: Filter<TSchema>,\r\n    update: UpdateFilter<TSchema>\r\n  ): Promise<UpdateResult | Document>;\r\n  updateMany(\r\n    filter: Filter<TSchema>,\r\n    update: UpdateFilter<TSchema>,\r\n    options: UpdateOptions\r\n  ): Promise<UpdateResult | Document>;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  updateMany(\r\n    filter: Filter<TSchema>,\r\n    update: UpdateFilter<TSchema>,\r\n    callback: Callback<UpdateResult | Document>\r\n  ): void;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  updateMany(\r\n    filter: Filter<TSchema>,\r\n    update: UpdateFilter<TSchema>,\r\n    options: UpdateOptions,\r\n    callback: Callback<UpdateResult | Document>\r\n  ): void;\r\n  updateMany(\r\n    filter: Filter<TSchema>,\r\n    update: UpdateFilter<TSchema>,\r\n    options?: UpdateOptions | Callback<UpdateResult | Document>,\r\n    callback?: Callback<UpdateResult | Document>\r\n  ): Promise<UpdateResult | Document> | void {\r\n    if (typeof options === 'function') (callback = options), (options = {});\r\n\r\n    return executeOperation(\r\n      this.s.db.s.client,\r\n      new UpdateManyOperation(\r\n        this as TODO_NODE_3286,\r\n        filter,\r\n        update,\r\n        resolveOptions(this, options)\r\n      ),\r\n      callback\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Delete a document from a collection\r\n   *\r\n   * @param filter - The filter used to select the document to remove\r\n   * @param options - Optional settings for the command\r\n   * @param callback - An optional callback, a Promise will be returned if none is provided\r\n   */\r\n  deleteOne(filter: Filter<TSchema>): Promise<DeleteResult>;\r\n  deleteOne(filter: Filter<TSchema>, options: DeleteOptions): Promise<DeleteResult>;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  deleteOne(filter: Filter<TSchema>, callback: Callback<DeleteResult>): void;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  deleteOne(\r\n    filter: Filter<TSchema>,\r\n    options: DeleteOptions,\r\n    callback?: Callback<DeleteResult>\r\n  ): void;\r\n  deleteOne(\r\n    filter: Filter<TSchema>,\r\n    options?: DeleteOptions | Callback<DeleteResult>,\r\n    callback?: Callback<DeleteResult>\r\n  ): Promise<DeleteResult> | void {\r\n    if (typeof options === 'function') (callback = options), (options = {});\r\n\r\n    return executeOperation(\r\n      this.s.db.s.client,\r\n      new DeleteOneOperation(this as TODO_NODE_3286, filter, resolveOptions(this, options)),\r\n      callback\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Delete multiple documents from a collection\r\n   *\r\n   * @param filter - The filter used to select the documents to remove\r\n   * @param options - Optional settings for the command\r\n   * @param callback - An optional callback, a Promise will be returned if none is provided\r\n   */\r\n  deleteMany(filter: Filter<TSchema>): Promise<DeleteResult>;\r\n  deleteMany(filter: Filter<TSchema>, options: DeleteOptions): Promise<DeleteResult>;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  deleteMany(filter: Filter<TSchema>, callback: Callback<DeleteResult>): void;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  deleteMany(\r\n    filter: Filter<TSchema>,\r\n    options: DeleteOptions,\r\n    callback: Callback<DeleteResult>\r\n  ): void;\r\n  deleteMany(\r\n    filter: Filter<TSchema>,\r\n    options?: DeleteOptions | Callback<DeleteResult>,\r\n    callback?: Callback<DeleteResult>\r\n  ): Promise<DeleteResult> | void {\r\n    if (filter == null) {\r\n      filter = {};\r\n      options = {};\r\n      callback = undefined;\r\n    } else if (typeof filter === 'function') {\r\n      callback = filter as Callback<DeleteResult>;\r\n      filter = {};\r\n      options = {};\r\n    } else if (typeof options === 'function') {\r\n      callback = options;\r\n      options = {};\r\n    }\r\n\r\n    return executeOperation(\r\n      this.s.db.s.client,\r\n      new DeleteManyOperation(this as TODO_NODE_3286, filter, resolveOptions(this, options)),\r\n      callback\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Rename the collection.\r\n   *\r\n   * @remarks\r\n   * This operation does not inherit options from the Db or MongoClient.\r\n   *\r\n   * @param newName - New name of of the collection.\r\n   * @param options - Optional settings for the command\r\n   * @param callback - An optional callback, a Promise will be returned if none is provided\r\n   */\r\n  rename(newName: string): Promise<Collection>;\r\n  rename(newName: string, options: RenameOptions): Promise<Collection>;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  rename(newName: string, callback: Callback<Collection>): void;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  rename(newName: string, options: RenameOptions, callback: Callback<Collection>): void;\r\n  rename(\r\n    newName: string,\r\n    options?: RenameOptions | Callback<Collection>,\r\n    callback?: Callback<Collection>\r\n  ): Promise<Collection> | void {\r\n    if (typeof options === 'function') (callback = options), (options = {});\r\n\r\n    // Intentionally, we do not inherit options from parent for this operation.\r\n    return executeOperation(\r\n      this.s.db.s.client,\r\n      new RenameOperation(this as TODO_NODE_3286, newName, {\r\n        ...options,\r\n        readPreference: ReadPreference.PRIMARY\r\n      }) as TODO_NODE_3286,\r\n      callback\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Drop the collection from the database, removing it permanently. New accesses will create a new collection.\r\n   *\r\n   * @param options - Optional settings for the command\r\n   * @param callback - An optional callback, a Promise will be returned if none is provided\r\n   */\r\n  drop(): Promise<boolean>;\r\n  drop(options: DropCollectionOptions): Promise<boolean>;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  drop(callback: Callback<boolean>): void;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  drop(options: DropCollectionOptions, callback: Callback<boolean>): void;\r\n  drop(\r\n    options?: DropCollectionOptions | Callback<boolean>,\r\n    callback?: Callback<boolean>\r\n  ): Promise<boolean> | void {\r\n    if (typeof options === 'function') (callback = options), (options = {});\r\n    options = options ?? {};\r\n\r\n    return executeOperation(\r\n      this.s.db.s.client,\r\n      new DropCollectionOperation(this.s.db, this.collectionName, options),\r\n      callback\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Fetches the first document that matches the filter\r\n   *\r\n   * @param filter - Query for find Operation\r\n   * @param options - Optional settings for the command\r\n   * @param callback - An optional callback, a Promise will be returned if none is provided\r\n   */\r\n  findOne(): Promise<WithId<TSchema> | null>;\r\n  findOne(filter: Filter<TSchema>): Promise<WithId<TSchema> | null>;\r\n  findOne(filter: Filter<TSchema>, options: FindOptions): Promise<WithId<TSchema> | null>;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  findOne(callback: Callback<WithId<TSchema> | null>): void;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  findOne(filter: Filter<TSchema>, callback: Callback<WithId<TSchema> | null>): void;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  findOne(\r\n    filter: Filter<TSchema>,\r\n    options: FindOptions,\r\n    callback: Callback<WithId<TSchema> | null>\r\n  ): void;\r\n\r\n  // allow an override of the schema.\r\n  findOne<T = TSchema>(): Promise<T | null>;\r\n  findOne<T = TSchema>(filter: Filter<TSchema>): Promise<T | null>;\r\n  findOne<T = TSchema>(filter: Filter<TSchema>, options?: FindOptions): Promise<T | null>;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  findOne<T = TSchema>(callback: Callback<T | null>): void;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  findOne<T = TSchema>(\r\n    filter: Filter<TSchema>,\r\n    options?: FindOptions,\r\n    callback?: Callback<T | null>\r\n  ): void;\r\n\r\n  findOne(\r\n    filter?: Filter<TSchema> | Callback<WithId<TSchema> | null>,\r\n    options?: FindOptions | Callback<WithId<TSchema> | null>,\r\n    callback?: Callback<WithId<TSchema> | null>\r\n  ): Promise<WithId<TSchema> | null> | void {\r\n    if (callback != null && typeof callback !== 'function') {\r\n      throw new MongoInvalidArgumentError(\r\n        'Third parameter to `findOne()` must be a callback or undefined'\r\n      );\r\n    }\r\n\r\n    if (typeof filter === 'function') {\r\n      callback = filter;\r\n      filter = {};\r\n      options = {};\r\n    }\r\n    if (typeof options === 'function') {\r\n      callback = options;\r\n      options = {};\r\n    }\r\n\r\n    const finalFilter = filter ?? {};\r\n    const finalOptions = options ?? {};\r\n    return this.find(finalFilter, finalOptions).limit(-1).batchSize(1).next(callback);\r\n  }\r\n\r\n  /**\r\n   * Creates a cursor for a filter that can be used to iterate over results from MongoDB\r\n   *\r\n   * @param filter - The filter predicate. If unspecified, then all documents in the collection will match the predicate\r\n   */\r\n  find(): FindCursor<WithId<TSchema>>;\r\n  find(filter: Filter<TSchema>, options?: FindOptions): FindCursor<WithId<TSchema>>;\r\n  find<T extends Document>(filter: Filter<TSchema>, options?: FindOptions): FindCursor<T>;\r\n  find(filter?: Filter<TSchema>, options?: FindOptions): FindCursor<WithId<TSchema>> {\r\n    if (arguments.length > 2) {\r\n      throw new MongoInvalidArgumentError(\r\n        'Method \"collection.find()\" accepts at most two arguments'\r\n      );\r\n    }\r\n    if (typeof options === 'function') {\r\n      throw new MongoInvalidArgumentError('Argument \"options\" must not be function');\r\n    }\r\n\r\n    return new FindCursor<WithId<TSchema>>(\r\n      this.s.db.s.client,\r\n      this.s.namespace,\r\n      filter,\r\n      resolveOptions(this as TODO_NODE_3286, options)\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Returns the options of the collection.\r\n   *\r\n   * @param options - Optional settings for the command\r\n   * @param callback - An optional callback, a Promise will be returned if none is provided\r\n   */\r\n  options(): Promise<Document>;\r\n  options(options: OperationOptions): Promise<Document>;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  options(callback: Callback<Document>): void;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  options(options: OperationOptions, callback: Callback<Document>): void;\r\n  options(\r\n    options?: OperationOptions | Callback<Document>,\r\n    callback?: Callback<Document>\r\n  ): Promise<Document> | void {\r\n    if (typeof options === 'function') (callback = options), (options = {});\r\n\r\n    return executeOperation(\r\n      this.s.db.s.client,\r\n      new OptionsOperation(this as TODO_NODE_3286, resolveOptions(this, options)),\r\n      callback\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Returns if the collection is a capped collection\r\n   *\r\n   * @param options - Optional settings for the command\r\n   * @param callback - An optional callback, a Promise will be returned if none is provided\r\n   */\r\n  isCapped(): Promise<boolean>;\r\n  isCapped(options: OperationOptions): Promise<boolean>;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  isCapped(callback: Callback<boolean>): void;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  isCapped(options: OperationOptions, callback: Callback<boolean>): void;\r\n  isCapped(\r\n    options?: OperationOptions | Callback<boolean>,\r\n    callback?: Callback<boolean>\r\n  ): Promise<boolean> | void {\r\n    if (typeof options === 'function') (callback = options), (options = {});\r\n\r\n    return executeOperation(\r\n      this.s.db.s.client,\r\n      new IsCappedOperation(this as TODO_NODE_3286, resolveOptions(this, options)),\r\n      callback\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Creates an index on the db and collection collection.\r\n   *\r\n   * @param indexSpec - The field name or index specification to create an index for\r\n   * @param options - Optional settings for the command\r\n   * @param callback - An optional callback, a Promise will be returned if none is provided\r\n   *\r\n   * @example\r\n   * ```ts\r\n   * const collection = client.db('foo').collection('bar');\r\n   *\r\n   * await collection.createIndex({ a: 1, b: -1 });\r\n   *\r\n   * // Alternate syntax for { c: 1, d: -1 } that ensures order of indexes\r\n   * await collection.createIndex([ [c, 1], [d, -1] ]);\r\n   *\r\n   * // Equivalent to { e: 1 }\r\n   * await collection.createIndex('e');\r\n   *\r\n   * // Equivalent to { f: 1, g: 1 }\r\n   * await collection.createIndex(['f', 'g'])\r\n   *\r\n   * // Equivalent to { h: 1, i: -1 }\r\n   * await collection.createIndex([ { h: 1 }, { i: -1 } ]);\r\n   *\r\n   * // Equivalent to { j: 1, k: -1, l: 2d }\r\n   * await collection.createIndex(['j', ['k', -1], { l: '2d' }])\r\n   * ```\r\n   */\r\n  createIndex(indexSpec: IndexSpecification): Promise<string>;\r\n  createIndex(indexSpec: IndexSpecification, options: CreateIndexesOptions): Promise<string>;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  createIndex(indexSpec: IndexSpecification, callback: Callback<string>): void;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  createIndex(\r\n    indexSpec: IndexSpecification,\r\n    options: CreateIndexesOptions,\r\n    callback: Callback<string>\r\n  ): void;\r\n  createIndex(\r\n    indexSpec: IndexSpecification,\r\n    options?: CreateIndexesOptions | Callback<string>,\r\n    callback?: Callback<string>\r\n  ): Promise<string> | void {\r\n    if (typeof options === 'function') (callback = options), (options = {});\r\n\r\n    return executeOperation(\r\n      this.s.db.s.client,\r\n      new CreateIndexOperation(\r\n        this as TODO_NODE_3286,\r\n        this.collectionName,\r\n        indexSpec,\r\n        resolveOptions(this, options)\r\n      ),\r\n      callback\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Creates multiple indexes in the collection, this method is only supported for\r\n   * MongoDB 2.6 or higher. Earlier version of MongoDB will throw a command not supported\r\n   * error.\r\n   *\r\n   * **Note**: Unlike {@link Collection#createIndex| createIndex}, this function takes in raw index specifications.\r\n   * Index specifications are defined {@link http://docs.mongodb.org/manual/reference/command/createIndexes/| here}.\r\n   *\r\n   * @param indexSpecs - An array of index specifications to be created\r\n   * @param options - Optional settings for the command\r\n   * @param callback - An optional callback, a Promise will be returned if none is provided\r\n   *\r\n   * @example\r\n   * ```ts\r\n   * const collection = client.db('foo').collection('bar');\r\n   * await collection.createIndexes([\r\n   *   // Simple index on field fizz\r\n   *   {\r\n   *     key: { fizz: 1 },\r\n   *   }\r\n   *   // wildcard index\r\n   *   {\r\n   *     key: { '$**': 1 }\r\n   *   },\r\n   *   // named index on darmok and jalad\r\n   *   {\r\n   *     key: { darmok: 1, jalad: -1 }\r\n   *     name: 'tanagra'\r\n   *   }\r\n   * ]);\r\n   * ```\r\n   */\r\n  createIndexes(indexSpecs: IndexDescription[]): Promise<string[]>;\r\n  createIndexes(indexSpecs: IndexDescription[], options: CreateIndexesOptions): Promise<string[]>;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  createIndexes(indexSpecs: IndexDescription[], callback: Callback<string[]>): void;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  createIndexes(\r\n    indexSpecs: IndexDescription[],\r\n    options: CreateIndexesOptions,\r\n    callback: Callback<string[]>\r\n  ): void;\r\n  createIndexes(\r\n    indexSpecs: IndexDescription[],\r\n    options?: CreateIndexesOptions | Callback<string[]>,\r\n    callback?: Callback<string[]>\r\n  ): Promise<string[]> | void {\r\n    if (typeof options === 'function') (callback = options), (options = {});\r\n    options = options ? Object.assign({}, options) : {};\r\n    if (typeof options.maxTimeMS !== 'number') delete options.maxTimeMS;\r\n\r\n    return executeOperation(\r\n      this.s.db.s.client,\r\n      new CreateIndexesOperation(\r\n        this as TODO_NODE_3286,\r\n        this.collectionName,\r\n        indexSpecs,\r\n        resolveOptions(this, options)\r\n      ),\r\n      callback\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Drops an index from this collection.\r\n   *\r\n   * @param indexName - Name of the index to drop.\r\n   * @param options - Optional settings for the command\r\n   * @param callback - An optional callback, a Promise will be returned if none is provided\r\n   */\r\n  dropIndex(indexName: string): Promise<Document>;\r\n  dropIndex(indexName: string, options: DropIndexesOptions): Promise<Document>;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  dropIndex(indexName: string, callback: Callback<Document>): void;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  dropIndex(indexName: string, options: DropIndexesOptions, callback: Callback<Document>): void;\r\n  dropIndex(\r\n    indexName: string,\r\n    options?: DropIndexesOptions | Callback<Document>,\r\n    callback?: Callback<Document>\r\n  ): Promise<Document> | void {\r\n    if (typeof options === 'function') (callback = options), (options = {});\r\n    options = resolveOptions(this, options);\r\n\r\n    // Run only against primary\r\n    options.readPreference = ReadPreference.primary;\r\n\r\n    return executeOperation(\r\n      this.s.db.s.client,\r\n      new DropIndexOperation(this as TODO_NODE_3286, indexName, options),\r\n      callback\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Drops all indexes from this collection.\r\n   *\r\n   * @param options - Optional settings for the command\r\n   * @param callback - An optional callback, a Promise will be returned if none is provided\r\n   */\r\n  dropIndexes(): Promise<Document>;\r\n  dropIndexes(options: DropIndexesOptions): Promise<Document>;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  dropIndexes(callback: Callback<Document>): void;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  dropIndexes(options: DropIndexesOptions, callback: Callback<Document>): void;\r\n  dropIndexes(\r\n    options?: DropIndexesOptions | Callback<Document>,\r\n    callback?: Callback<Document>\r\n  ): Promise<Document> | void {\r\n    if (typeof options === 'function') (callback = options), (options = {});\r\n\r\n    return executeOperation(\r\n      this.s.db.s.client,\r\n      new DropIndexesOperation(this as TODO_NODE_3286, resolveOptions(this, options)),\r\n      callback\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Get the list of all indexes information for the collection.\r\n   *\r\n   * @param options - Optional settings for the command\r\n   */\r\n  listIndexes(options?: ListIndexesOptions): ListIndexesCursor {\r\n    return new ListIndexesCursor(this as TODO_NODE_3286, resolveOptions(this, options));\r\n  }\r\n\r\n  /**\r\n   * Checks if one or more indexes exist on the collection, fails on first non-existing index\r\n   *\r\n   * @param indexes - One or more index names to check.\r\n   * @param options - Optional settings for the command\r\n   * @param callback - An optional callback, a Promise will be returned if none is provided\r\n   */\r\n  indexExists(indexes: string | string[]): Promise<boolean>;\r\n  indexExists(indexes: string | string[], options: IndexInformationOptions): Promise<boolean>;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  indexExists(indexes: string | string[], callback: Callback<boolean>): void;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  indexExists(\r\n    indexes: string | string[],\r\n    options: IndexInformationOptions,\r\n    callback: Callback<boolean>\r\n  ): void;\r\n  indexExists(\r\n    indexes: string | string[],\r\n    options?: IndexInformationOptions | Callback<boolean>,\r\n    callback?: Callback<boolean>\r\n  ): Promise<boolean> | void {\r\n    if (typeof options === 'function') (callback = options), (options = {});\r\n\r\n    return executeOperation(\r\n      this.s.db.s.client,\r\n      new IndexExistsOperation(this as TODO_NODE_3286, indexes, resolveOptions(this, options)),\r\n      callback\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Retrieves this collections index info.\r\n   *\r\n   * @param options - Optional settings for the command\r\n   * @param callback - An optional callback, a Promise will be returned if none is provided\r\n   */\r\n  indexInformation(): Promise<Document>;\r\n  indexInformation(options: IndexInformationOptions): Promise<Document>;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  indexInformation(callback: Callback<Document>): void;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  indexInformation(options: IndexInformationOptions, callback: Callback<Document>): void;\r\n  indexInformation(\r\n    options?: IndexInformationOptions | Callback<Document>,\r\n    callback?: Callback<Document>\r\n  ): Promise<Document> | void {\r\n    if (typeof options === 'function') (callback = options), (options = {});\r\n\r\n    return executeOperation(\r\n      this.s.db.s.client,\r\n      new IndexInformationOperation(this.s.db, this.collectionName, resolveOptions(this, options)),\r\n      callback\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Gets an estimate of the count of documents in a collection using collection metadata.\r\n   * This will always run a count command on all server versions.\r\n   *\r\n   * due to an oversight in versions 5.0.0-5.0.8 of MongoDB, the count command,\r\n   * which estimatedDocumentCount uses in its implementation, was not included in v1 of\r\n   * the Stable API, and so users of the Stable API with estimatedDocumentCount are\r\n   * recommended to upgrade their server version to 5.0.9+ or set apiStrict: false to avoid\r\n   * encountering errors.\r\n   *\r\n   * @see {@link https://www.mongodb.com/docs/manual/reference/command/count/#behavior|Count: Behavior}\r\n   * @param options - Optional settings for the command\r\n   * @param callback - An optional callback, a Promise will be returned if none is provided\r\n   */\r\n  estimatedDocumentCount(): Promise<number>;\r\n  estimatedDocumentCount(options: EstimatedDocumentCountOptions): Promise<number>;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  estimatedDocumentCount(callback: Callback<number>): void;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  estimatedDocumentCount(options: EstimatedDocumentCountOptions, callback: Callback<number>): void;\r\n  estimatedDocumentCount(\r\n    options?: EstimatedDocumentCountOptions | Callback<number>,\r\n    callback?: Callback<number>\r\n  ): Promise<number> | void {\r\n    if (typeof options === 'function') (callback = options), (options = {});\r\n    return executeOperation(\r\n      this.s.db.s.client,\r\n      new EstimatedDocumentCountOperation(this as TODO_NODE_3286, resolveOptions(this, options)),\r\n      callback\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Gets the number of documents matching the filter.\r\n   * For a fast count of the total documents in a collection see {@link Collection#estimatedDocumentCount| estimatedDocumentCount}.\r\n   * **Note**: When migrating from {@link Collection#count| count} to {@link Collection#countDocuments| countDocuments}\r\n   * the following query operators must be replaced:\r\n   *\r\n   * | Operator | Replacement |\r\n   * | -------- | ----------- |\r\n   * | `$where`   | [`$expr`][1] |\r\n   * | `$near`    | [`$geoWithin`][2] with [`$center`][3] |\r\n   * | `$nearSphere` | [`$geoWithin`][2] with [`$centerSphere`][4] |\r\n   *\r\n   * [1]: https://docs.mongodb.com/manual/reference/operator/query/expr/\r\n   * [2]: https://docs.mongodb.com/manual/reference/operator/query/geoWithin/\r\n   * [3]: https://docs.mongodb.com/manual/reference/operator/query/center/#op._S_center\r\n   * [4]: https://docs.mongodb.com/manual/reference/operator/query/centerSphere/#op._S_centerSphere\r\n   *\r\n   * @param filter - The filter for the count\r\n   * @param options - Optional settings for the command\r\n   * @param callback - An optional callback, a Promise will be returned if none is provided\r\n   *\r\n   * @see https://docs.mongodb.com/manual/reference/operator/query/expr/\r\n   * @see https://docs.mongodb.com/manual/reference/operator/query/geoWithin/\r\n   * @see https://docs.mongodb.com/manual/reference/operator/query/center/#op._S_center\r\n   * @see https://docs.mongodb.com/manual/reference/operator/query/centerSphere/#op._S_centerSphere\r\n   */\r\n  countDocuments(): Promise<number>;\r\n  countDocuments(filter: Filter<TSchema>): Promise<number>;\r\n  countDocuments(filter: Filter<TSchema>, options: CountDocumentsOptions): Promise<number>;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  countDocuments(callback: Callback<number>): void;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  countDocuments(filter: Filter<TSchema>, callback: Callback<number>): void;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  countDocuments(\r\n    filter: Filter<TSchema>,\r\n    options: CountDocumentsOptions,\r\n    callback: Callback<number>\r\n  ): void;\r\n  countDocuments(\r\n    filter?: Document | CountDocumentsOptions | Callback<number>,\r\n    options?: CountDocumentsOptions | Callback<number>,\r\n    callback?: Callback<number>\r\n  ): Promise<number> | void {\r\n    if (filter == null) {\r\n      (filter = {}), (options = {}), (callback = undefined);\r\n    } else if (typeof filter === 'function') {\r\n      (callback = filter as Callback<number>), (filter = {}), (options = {});\r\n    } else {\r\n      if (arguments.length === 2) {\r\n        if (typeof options === 'function') (callback = options), (options = {});\r\n      }\r\n    }\r\n\r\n    filter ??= {};\r\n    return executeOperation(\r\n      this.s.db.s.client,\r\n      new CountDocumentsOperation(\r\n        this as TODO_NODE_3286,\r\n        filter,\r\n        resolveOptions(this, options as CountDocumentsOptions)\r\n      ),\r\n      callback\r\n    );\r\n  }\r\n\r\n  /**\r\n   * The distinct command returns a list of distinct values for the given key across a collection.\r\n   *\r\n   * @param key - Field of the document to find distinct values for\r\n   * @param filter - The filter for filtering the set of documents to which we apply the distinct filter.\r\n   * @param options - Optional settings for the command\r\n   * @param callback - An optional callback, a Promise will be returned if none is provided\r\n   */\r\n  distinct<Key extends keyof WithId<TSchema>>(\r\n    key: Key\r\n  ): Promise<Array<Flatten<WithId<TSchema>[Key]>>>;\r\n  distinct<Key extends keyof WithId<TSchema>>(\r\n    key: Key,\r\n    filter: Filter<TSchema>\r\n  ): Promise<Array<Flatten<WithId<TSchema>[Key]>>>;\r\n  distinct<Key extends keyof WithId<TSchema>>(\r\n    key: Key,\r\n    filter: Filter<TSchema>,\r\n    options: DistinctOptions\r\n  ): Promise<Array<Flatten<WithId<TSchema>[Key]>>>;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  distinct<Key extends keyof WithId<TSchema>>(\r\n    key: Key,\r\n    callback: Callback<Array<Flatten<WithId<TSchema>[Key]>>>\r\n  ): void;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  distinct<Key extends keyof WithId<TSchema>>(\r\n    key: Key,\r\n    filter: Filter<TSchema>,\r\n    callback: Callback<Array<Flatten<WithId<TSchema>[Key]>>>\r\n  ): void;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  distinct<Key extends keyof WithId<TSchema>>(\r\n    key: Key,\r\n    filter: Filter<TSchema>,\r\n    options: DistinctOptions,\r\n    callback: Callback<Array<Flatten<WithId<TSchema>[Key]>>>\r\n  ): void;\r\n\r\n  // Embedded documents overload\r\n  distinct(key: string): Promise<any[]>;\r\n  distinct(key: string, filter: Filter<TSchema>): Promise<any[]>;\r\n  distinct(key: string, filter: Filter<TSchema>, options: DistinctOptions): Promise<any[]>;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  distinct(key: string, callback: Callback<any[]>): void;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  distinct(key: string, filter: Filter<TSchema>, callback: Callback<any[]>): void;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  distinct(\r\n    key: string,\r\n    filter: Filter<TSchema>,\r\n    options: DistinctOptions,\r\n    callback: Callback<any[]>\r\n  ): void;\r\n  // Implementation\r\n  distinct<Key extends keyof WithId<TSchema>>(\r\n    key: Key,\r\n    filter?: Filter<TSchema> | DistinctOptions | Callback<any[]>,\r\n    options?: DistinctOptions | Callback<any[]>,\r\n    callback?: Callback<any[]>\r\n  ): Promise<any[]> | void {\r\n    if (typeof filter === 'function') {\r\n      (callback = filter), (filter = {}), (options = {});\r\n    } else {\r\n      if (arguments.length === 3 && typeof options === 'function') {\r\n        (callback = options), (options = {});\r\n      }\r\n    }\r\n\r\n    filter ??= {};\r\n    return executeOperation(\r\n      this.s.db.s.client,\r\n      new DistinctOperation(\r\n        this as TODO_NODE_3286,\r\n        key as TODO_NODE_3286,\r\n        filter,\r\n        resolveOptions(this, options as DistinctOptions)\r\n      ),\r\n      callback\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Retrieve all the indexes on the collection.\r\n   *\r\n   * @param options - Optional settings for the command\r\n   * @param callback - An optional callback, a Promise will be returned if none is provided\r\n   */\r\n  indexes(): Promise<Document[]>;\r\n  indexes(options: IndexInformationOptions): Promise<Document[]>;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  indexes(callback: Callback<Document[]>): void;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  indexes(options: IndexInformationOptions, callback: Callback<Document[]>): void;\r\n  indexes(\r\n    options?: IndexInformationOptions | Callback<Document[]>,\r\n    callback?: Callback<Document[]>\r\n  ): Promise<Document[]> | void {\r\n    if (typeof options === 'function') (callback = options), (options = {});\r\n\r\n    return executeOperation(\r\n      this.s.db.s.client,\r\n      new IndexesOperation(this as TODO_NODE_3286, resolveOptions(this, options)),\r\n      callback\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Get all the collection statistics.\r\n   *\r\n   * @param options - Optional settings for the command\r\n   * @param callback - An optional callback, a Promise will be returned if none is provided\r\n   */\r\n  stats(): Promise<CollStats>;\r\n  stats(options: CollStatsOptions): Promise<CollStats>;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  stats(callback: Callback<CollStats>): void;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  stats(options: CollStatsOptions, callback: Callback<CollStats>): void;\r\n  stats(\r\n    options?: CollStatsOptions | Callback<CollStats>,\r\n    callback?: Callback<CollStats>\r\n  ): Promise<CollStats> | void {\r\n    if (typeof options === 'function') (callback = options), (options = {});\r\n    options = options ?? {};\r\n\r\n    return executeOperation(\r\n      this.s.db.s.client,\r\n      new CollStatsOperation(this as TODO_NODE_3286, options) as TODO_NODE_3286,\r\n      callback\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Find a document and delete it in one atomic operation. Requires a write lock for the duration of the operation.\r\n   *\r\n   * @param filter - The filter used to select the document to remove\r\n   * @param options - Optional settings for the command\r\n   * @param callback - An optional callback, a Promise will be returned if none is provided\r\n   */\r\n  findOneAndDelete(filter: Filter<TSchema>): Promise<ModifyResult<TSchema>>;\r\n  findOneAndDelete(\r\n    filter: Filter<TSchema>,\r\n    options: FindOneAndDeleteOptions\r\n  ): Promise<ModifyResult<TSchema>>;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  findOneAndDelete(filter: Filter<TSchema>, callback: Callback<ModifyResult<TSchema>>): void;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  findOneAndDelete(\r\n    filter: Filter<TSchema>,\r\n    options: FindOneAndDeleteOptions,\r\n    callback: Callback<ModifyResult<TSchema>>\r\n  ): void;\r\n  findOneAndDelete(\r\n    filter: Filter<TSchema>,\r\n    options?: FindOneAndDeleteOptions | Callback<ModifyResult<TSchema>>,\r\n    callback?: Callback<ModifyResult<TSchema>>\r\n  ): Promise<Document> | void {\r\n    if (typeof options === 'function') (callback = options), (options = {});\r\n\r\n    return executeOperation(\r\n      this.s.db.s.client,\r\n      new FindOneAndDeleteOperation(\r\n        this as TODO_NODE_3286,\r\n        filter,\r\n        resolveOptions(this, options)\r\n      ) as TODO_NODE_3286,\r\n      callback\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Find a document and replace it in one atomic operation. Requires a write lock for the duration of the operation.\r\n   *\r\n   * @param filter - The filter used to select the document to replace\r\n   * @param replacement - The Document that replaces the matching document\r\n   * @param options - Optional settings for the command\r\n   * @param callback - An optional callback, a Promise will be returned if none is provided\r\n   */\r\n  findOneAndReplace(\r\n    filter: Filter<TSchema>,\r\n    replacement: WithoutId<TSchema>\r\n  ): Promise<ModifyResult<TSchema>>;\r\n  findOneAndReplace(\r\n    filter: Filter<TSchema>,\r\n    replacement: WithoutId<TSchema>,\r\n    options: FindOneAndReplaceOptions\r\n  ): Promise<ModifyResult<TSchema>>;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  findOneAndReplace(\r\n    filter: Filter<TSchema>,\r\n    replacement: WithoutId<TSchema>,\r\n    callback: Callback<ModifyResult<TSchema>>\r\n  ): void;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  findOneAndReplace(\r\n    filter: Filter<TSchema>,\r\n    replacement: WithoutId<TSchema>,\r\n    options: FindOneAndReplaceOptions,\r\n    callback: Callback<ModifyResult<TSchema>>\r\n  ): void;\r\n  findOneAndReplace(\r\n    filter: Filter<TSchema>,\r\n    replacement: WithoutId<TSchema>,\r\n    options?: FindOneAndReplaceOptions | Callback<ModifyResult<TSchema>>,\r\n    callback?: Callback<ModifyResult<TSchema>>\r\n  ): Promise<ModifyResult<TSchema>> | void {\r\n    if (typeof options === 'function') (callback = options), (options = {});\r\n\r\n    return executeOperation(\r\n      this.s.db.s.client,\r\n      new FindOneAndReplaceOperation(\r\n        this as TODO_NODE_3286,\r\n        filter,\r\n        replacement,\r\n        resolveOptions(this, options)\r\n      ) as TODO_NODE_3286,\r\n      callback\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Find a document and update it in one atomic operation. Requires a write lock for the duration of the operation.\r\n   *\r\n   * @param filter - The filter used to select the document to update\r\n   * @param update - Update operations to be performed on the document\r\n   * @param options - Optional settings for the command\r\n   * @param callback - An optional callback, a Promise will be returned if none is provided\r\n   */\r\n  findOneAndUpdate(\r\n    filter: Filter<TSchema>,\r\n    update: UpdateFilter<TSchema>\r\n  ): Promise<ModifyResult<TSchema>>;\r\n  findOneAndUpdate(\r\n    filter: Filter<TSchema>,\r\n    update: UpdateFilter<TSchema>,\r\n    options: FindOneAndUpdateOptions\r\n  ): Promise<ModifyResult<TSchema>>;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  findOneAndUpdate(\r\n    filter: Filter<TSchema>,\r\n    update: UpdateFilter<TSchema>,\r\n    callback: Callback<ModifyResult<TSchema>>\r\n  ): void;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  findOneAndUpdate(\r\n    filter: Filter<TSchema>,\r\n    update: UpdateFilter<TSchema>,\r\n    options: FindOneAndUpdateOptions,\r\n    callback: Callback<ModifyResult<TSchema>>\r\n  ): void;\r\n  findOneAndUpdate(\r\n    filter: Filter<TSchema>,\r\n    update: UpdateFilter<TSchema>,\r\n    options?: FindOneAndUpdateOptions | Callback<ModifyResult<TSchema>>,\r\n    callback?: Callback<ModifyResult<TSchema>>\r\n  ): Promise<ModifyResult<TSchema>> | void {\r\n    if (typeof options === 'function') (callback = options), (options = {});\r\n\r\n    return executeOperation(\r\n      this.s.db.s.client,\r\n      new FindOneAndUpdateOperation(\r\n        this as TODO_NODE_3286,\r\n        filter,\r\n        update,\r\n        resolveOptions(this, options)\r\n      ) as TODO_NODE_3286,\r\n      callback\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Execute an aggregation framework pipeline against the collection, needs MongoDB \\>= 2.2\r\n   *\r\n   * @param pipeline - An array of aggregation pipelines to execute\r\n   * @param options - Optional settings for the command\r\n   */\r\n  aggregate<T extends Document = Document>(\r\n    pipeline: Document[] = [],\r\n    options?: AggregateOptions\r\n  ): AggregationCursor<T> {\r\n    if (arguments.length > 2) {\r\n      throw new MongoInvalidArgumentError(\r\n        'Method \"collection.aggregate()\" accepts at most two arguments'\r\n      );\r\n    }\r\n    if (!Array.isArray(pipeline)) {\r\n      throw new MongoInvalidArgumentError(\r\n        'Argument \"pipeline\" must be an array of aggregation stages'\r\n      );\r\n    }\r\n    if (typeof options === 'function') {\r\n      throw new MongoInvalidArgumentError('Argument \"options\" must not be function');\r\n    }\r\n\r\n    return new AggregationCursor(\r\n      this.s.db.s.client,\r\n      this.s.namespace,\r\n      pipeline,\r\n      resolveOptions(this, options)\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Create a new Change Stream, watching for new changes (insertions, updates, replacements, deletions, and invalidations) in this collection.\r\n   *\r\n   * @remarks\r\n   * watch() accepts two generic arguments for distinct use cases:\r\n   * - The first is to override the schema that may be defined for this specific collection\r\n   * - The second is to override the shape of the change stream document entirely, if it is not provided the type will default to ChangeStreamDocument of the first argument\r\n   * @example\r\n   * By just providing the first argument I can type the change to be `ChangeStreamDocument<{ _id: number }>`\r\n   * ```ts\r\n   * collection.watch<{ _id: number }>()\r\n   *   .on('change', change => console.log(change._id.toFixed(4)));\r\n   * ```\r\n   *\r\n   * @example\r\n   * Passing a second argument provides a way to reflect the type changes caused by an advanced pipeline.\r\n   * Here, we are using a pipeline to have MongoDB filter for insert changes only and add a comment.\r\n   * No need start from scratch on the ChangeStreamInsertDocument type!\r\n   * By using an intersection we can save time and ensure defaults remain the same type!\r\n   * ```ts\r\n   * collection\r\n   *   .watch<Schema, ChangeStreamInsertDocument<Schema> & { comment: string }>([\r\n   *     { $addFields: { comment: 'big changes' } },\r\n   *     { $match: { operationType: 'insert' } }\r\n   *   ])\r\n   *   .on('change', change => {\r\n   *     change.comment.startsWith('big');\r\n   *     change.operationType === 'insert';\r\n   *     // No need to narrow in code because the generics did that for us!\r\n   *     expectType<Schema>(change.fullDocument);\r\n   *   });\r\n   * ```\r\n   *\r\n   * @param pipeline - An array of {@link https://docs.mongodb.com/manual/reference/operator/aggregation-pipeline/|aggregation pipeline stages} through which to pass change stream documents. This allows for filtering (using $match) and manipulating the change stream documents.\r\n   * @param options - Optional settings for the command\r\n   * @typeParam TLocal - Type of the data being detected by the change stream\r\n   * @typeParam TChange - Type of the whole change stream document emitted\r\n   */\r\n  watch<TLocal extends Document = TSchema, TChange extends Document = ChangeStreamDocument<TLocal>>(\r\n    pipeline: Document[] = [],\r\n    options: ChangeStreamOptions = {}\r\n  ): ChangeStream<TLocal, TChange> {\r\n    // Allow optionally not specifying a pipeline\r\n    if (!Array.isArray(pipeline)) {\r\n      options = pipeline;\r\n      pipeline = [];\r\n    }\r\n\r\n    return new ChangeStream<TLocal, TChange>(this, pipeline, resolveOptions(this, options));\r\n  }\r\n\r\n  /**\r\n   * Run Map Reduce across a collection. Be aware that the inline option for out will return an array of results not a collection.\r\n   *\r\n   * @deprecated collection.mapReduce is deprecated. Use the aggregation pipeline instead. Visit https://docs.mongodb.com/manual/reference/map-reduce-to-aggregation-pipeline for more information on how to translate map-reduce operations to the aggregation pipeline.\r\n   * @param map - The mapping function.\r\n   * @param reduce - The reduce function.\r\n   * @param options - Optional settings for the command\r\n   * @param callback - An optional callback, a Promise will be returned if none is provided\r\n   */\r\n  mapReduce<TKey = any, TValue = any>(\r\n    map: string | MapFunction<TSchema>,\r\n    reduce: string | ReduceFunction<TKey, TValue>\r\n  ): Promise<Document | Document[]>;\r\n  mapReduce<TKey = any, TValue = any>(\r\n    map: string | MapFunction<TSchema>,\r\n    reduce: string | ReduceFunction<TKey, TValue>,\r\n    options: MapReduceOptions<TKey, TValue>\r\n  ): Promise<Document | Document[]>;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  mapReduce<TKey = any, TValue = any>(\r\n    map: string | MapFunction<TSchema>,\r\n    reduce: string | ReduceFunction<TKey, TValue>,\r\n    callback: Callback<Document | Document[]>\r\n  ): void;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  mapReduce<TKey = any, TValue = any>(\r\n    map: string | MapFunction<TSchema>,\r\n    reduce: string | ReduceFunction<TKey, TValue>,\r\n    options: MapReduceOptions<TKey, TValue>,\r\n    callback: Callback<Document | Document[]>\r\n  ): void;\r\n  mapReduce<TKey = any, TValue = any>(\r\n    map: string | MapFunction<TSchema>,\r\n    reduce: string | ReduceFunction<TKey, TValue>,\r\n    options?: MapReduceOptions<TKey, TValue> | Callback<Document | Document[]>,\r\n    callback?: Callback<Document | Document[]>\r\n  ): Promise<Document | Document[]> | void {\r\n    emitWarningOnce(\r\n      'collection.mapReduce is deprecated. Use the aggregation pipeline instead. Visit https://docs.mongodb.com/manual/reference/map-reduce-to-aggregation-pipeline for more information on how to translate map-reduce operations to the aggregation pipeline.'\r\n    );\r\n    if ('function' === typeof options) (callback = options), (options = {});\r\n    // Out must always be defined (make sure we don't break weirdly on pre 1.8+ servers)\r\n    // TODO NODE-3339: Figure out if this is still necessary given we no longer officially support pre-1.8\r\n    if (options?.out == null) {\r\n      throw new MongoInvalidArgumentError(\r\n        'Option \"out\" must be defined, see mongodb docs for possible values'\r\n      );\r\n    }\r\n\r\n    if ('function' === typeof map) {\r\n      map = map.toString();\r\n    }\r\n\r\n    if ('function' === typeof reduce) {\r\n      reduce = reduce.toString();\r\n    }\r\n\r\n    if ('function' === typeof options.finalize) {\r\n      options.finalize = options.finalize.toString();\r\n    }\r\n\r\n    return executeOperation(\r\n      this.s.db.s.client,\r\n      new MapReduceOperation(\r\n        this as TODO_NODE_3286,\r\n        map,\r\n        reduce,\r\n        resolveOptions(this, options) as TODO_NODE_3286\r\n      ),\r\n      callback\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Initiate an Out of order batch write operation. All operations will be buffered into insert/update/remove commands executed out of order.\r\n   *\r\n   * @throws MongoNotConnectedError\r\n   * @remarks\r\n   * **NOTE:** MongoClient must be connected prior to calling this method due to a known limitation in this legacy implementation.\r\n   * However, `collection.bulkWrite()` provides an equivalent API that does not require prior connecting.\r\n   */\r\n  initializeUnorderedBulkOp(options?: BulkWriteOptions): UnorderedBulkOperation {\r\n    return new UnorderedBulkOperation(this as TODO_NODE_3286, resolveOptions(this, options));\r\n  }\r\n\r\n  /**\r\n   * Initiate an In order bulk write operation. Operations will be serially executed in the order they are added, creating a new operation for each switch in types.\r\n   *\r\n   * @throws MongoNotConnectedError\r\n   * @remarks\r\n   * **NOTE:** MongoClient must be connected prior to calling this method due to a known limitation in this legacy implementation.\r\n   * However, `collection.bulkWrite()` provides an equivalent API that does not require prior connecting.\r\n   */\r\n  initializeOrderedBulkOp(options?: BulkWriteOptions): OrderedBulkOperation {\r\n    return new OrderedBulkOperation(this as TODO_NODE_3286, resolveOptions(this, options));\r\n  }\r\n\r\n  /** Get the db scoped logger */\r\n  getLogger(): Logger {\r\n    return this.s.db.s.logger;\r\n  }\r\n\r\n  get logger(): Logger {\r\n    return this.s.db.s.logger;\r\n  }\r\n\r\n  /**\r\n   * Inserts a single document or a an array of documents into MongoDB. If documents passed in do not contain the **_id** field,\r\n   * one will be added to each of the documents missing it by the driver, mutating the document. This behavior\r\n   * can be overridden by setting the **forceServerObjectId** flag.\r\n   *\r\n   * @deprecated Use insertOne, insertMany or bulkWrite instead. Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance\r\n   * @param docs - The documents to insert\r\n   * @param options - Optional settings for the command\r\n   * @param callback - An optional callback, a Promise will be returned if none is provided\r\n   */\r\n  insert(\r\n    docs: OptionalUnlessRequiredId<TSchema>[],\r\n    options: BulkWriteOptions,\r\n    callback: Callback<InsertManyResult<TSchema>>\r\n  ): Promise<InsertManyResult<TSchema>> | void {\r\n    emitWarningOnce(\r\n      'collection.insert is deprecated. Use insertOne, insertMany or bulkWrite instead.'\r\n    );\r\n    if (typeof options === 'function') (callback = options), (options = {});\r\n    options = options || { ordered: false };\r\n    docs = !Array.isArray(docs) ? [docs] : docs;\r\n\r\n    if (options.keepGoing === true) {\r\n      options.ordered = false;\r\n    }\r\n\r\n    return this.insertMany(docs, options, callback);\r\n  }\r\n\r\n  /**\r\n   * Updates documents.\r\n   *\r\n   * @deprecated use updateOne, updateMany or bulkWrite. Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance\r\n   * @param filter - The filter for the update operation.\r\n   * @param update - The update operations to be applied to the documents\r\n   * @param options - Optional settings for the command\r\n   * @param callback - An optional callback, a Promise will be returned if none is provided\r\n   */\r\n  update(\r\n    filter: Filter<TSchema>,\r\n    update: UpdateFilter<TSchema>,\r\n    options: UpdateOptions,\r\n    callback: Callback<Document>\r\n  ): Promise<UpdateResult> | void {\r\n    emitWarningOnce(\r\n      'collection.update is deprecated. Use updateOne, updateMany, or bulkWrite instead.'\r\n    );\r\n    if (typeof options === 'function') (callback = options), (options = {});\r\n    options = options ?? {};\r\n\r\n    return this.updateMany(filter, update, options, callback);\r\n  }\r\n\r\n  /**\r\n   * Remove documents.\r\n   *\r\n   * @deprecated use deleteOne, deleteMany or bulkWrite. Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance\r\n   * @param filter - The filter for the remove operation.\r\n   * @param options - Optional settings for the command\r\n   * @param callback - An optional callback, a Promise will be returned if none is provided\r\n   */\r\n  remove(\r\n    filter: Filter<TSchema>,\r\n    options: DeleteOptions,\r\n    callback: Callback\r\n  ): Promise<DeleteResult> | void {\r\n    emitWarningOnce(\r\n      'collection.remove is deprecated. Use deleteOne, deleteMany, or bulkWrite instead.'\r\n    );\r\n    if (typeof options === 'function') (callback = options), (options = {});\r\n    options = options ?? {};\r\n\r\n    return this.deleteMany(filter, options, callback);\r\n  }\r\n\r\n  /**\r\n   * An estimated count of matching documents in the db to a filter.\r\n   *\r\n   * **NOTE:** This method has been deprecated, since it does not provide an accurate count of the documents\r\n   * in a collection. To obtain an accurate count of documents in the collection, use {@link Collection#countDocuments| countDocuments}.\r\n   * To obtain an estimated count of all documents in the collection, use {@link Collection#estimatedDocumentCount| estimatedDocumentCount}.\r\n   *\r\n   * @deprecated use {@link Collection#countDocuments| countDocuments} or {@link Collection#estimatedDocumentCount| estimatedDocumentCount} instead\r\n   *\r\n   * @param filter - The filter for the count.\r\n   * @param options - Optional settings for the command\r\n   * @param callback - An optional callback, a Promise will be returned if none is provided\r\n   */\r\n  count(): Promise<number>;\r\n  count(filter: Filter<TSchema>): Promise<number>;\r\n  count(filter: Filter<TSchema>, options: CountOptions): Promise<number>;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  count(callback: Callback<number>): void;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  count(filter: Filter<TSchema>, callback: Callback<number>): void;\r\n  /** @deprecated Callbacks are deprecated and will be removed in the next major version. See [mongodb-legacy](https://github.com/mongodb-js/nodejs-mongodb-legacy) for migration assistance */\r\n  count(\r\n    filter: Filter<TSchema>,\r\n    options: CountOptions,\r\n    callback: Callback<number>\r\n  ): Promise<number> | void;\r\n  count(\r\n    filter?: Filter<TSchema> | CountOptions | Callback<number>,\r\n    options?: CountOptions | Callback<number>,\r\n    callback?: Callback<number>\r\n  ): Promise<number> | void {\r\n    if (typeof filter === 'function') {\r\n      (callback = filter), (filter = {}), (options = {});\r\n    } else {\r\n      if (typeof options === 'function') (callback = options), (options = {});\r\n    }\r\n\r\n    filter ??= {};\r\n    return executeOperation(\r\n      this.s.db.s.client,\r\n      new CountOperation(\r\n        MongoDBNamespace.fromString(this.namespace),\r\n        filter,\r\n        resolveOptions(this, options)\r\n      ),\r\n      callback\r\n    );\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"script","externalDependencies":[]}