{"ast":null,"code":"'use strict';\n\n/*!\r\n * ignore\r\n */\nmodule.exports = applyQueryMiddleware;\nconst validOps = require('./validOps');\n\n/*!\r\n * ignore\r\n */\n\napplyQueryMiddleware.middlewareFunctions = validOps.concat(['validate']);\n\n/**\r\n * Apply query middleware\r\n *\r\n * @param {Query} Query constructor\r\n * @param {Model} model\r\n * @api private\r\n */\n\nfunction applyQueryMiddleware(Query, model) {\n  const kareemOptions = {\n    useErrorHandlers: true,\n    numCallbackParams: 1,\n    nullResultByDefault: true\n  };\n  const middleware = model.hooks.filter(hook => {\n    const contexts = _getContexts(hook);\n    if (hook.name === 'updateOne') {\n      return contexts.query == null || !!contexts.query;\n    }\n    if (hook.name === 'deleteOne') {\n      return !!contexts.query || Object.keys(contexts).length === 0;\n    }\n    if (hook.name === 'validate' || hook.name === 'remove') {\n      return !!contexts.query;\n    }\n    if (hook.query != null || hook.document != null) {\n      return !!hook.query;\n    }\n    return true;\n  });\n\n  // `update()` thunk has a different name because `_update` was already taken\n  Query.prototype._execUpdate = middleware.createWrapper('update', Query.prototype._execUpdate, null, kareemOptions);\n  // `distinct()` thunk has a different name because `_distinct` was already taken\n  Query.prototype.__distinct = middleware.createWrapper('distinct', Query.prototype.__distinct, null, kareemOptions);\n\n  // `validate()` doesn't have a thunk because it doesn't execute a query.\n  Query.prototype.validate = middleware.createWrapper('validate', Query.prototype.validate, null, kareemOptions);\n  applyQueryMiddleware.middlewareFunctions.filter(v => v !== 'update' && v !== 'distinct' && v !== 'validate').forEach(fn => {\n    Query.prototype[`_${fn}`] = middleware.createWrapper(fn, Query.prototype[`_${fn}`], null, kareemOptions);\n  });\n}\nfunction _getContexts(hook) {\n  const ret = {};\n  if (hook.hasOwnProperty('query')) {\n    ret.query = hook.query;\n  }\n  if (hook.hasOwnProperty('document')) {\n    ret.document = hook.document;\n  }\n  return ret;\n}","map":{"version":3,"names":["module","exports","applyQueryMiddleware","validOps","require","middlewareFunctions","concat","Query","model","kareemOptions","useErrorHandlers","numCallbackParams","nullResultByDefault","middleware","hooks","filter","hook","contexts","_getContexts","name","query","Object","keys","length","document","prototype","_execUpdate","createWrapper","__distinct","validate","v","forEach","fn","ret","hasOwnProperty"],"sources":["C:/Users/91930/Desktop/Github projects/Pharmacy Demo/back-end/node_modules/mongoose/lib/helpers/query/applyQueryMiddleware.js"],"sourcesContent":["'use strict';\r\n\r\n/*!\r\n * ignore\r\n */\r\n\r\nmodule.exports = applyQueryMiddleware;\r\n\r\nconst validOps = require('./validOps');\r\n\r\n/*!\r\n * ignore\r\n */\r\n\r\napplyQueryMiddleware.middlewareFunctions = validOps.concat([\r\n  'validate'\r\n]);\r\n\r\n/**\r\n * Apply query middleware\r\n *\r\n * @param {Query} Query constructor\r\n * @param {Model} model\r\n * @api private\r\n */\r\n\r\nfunction applyQueryMiddleware(Query, model) {\r\n  const kareemOptions = {\r\n    useErrorHandlers: true,\r\n    numCallbackParams: 1,\r\n    nullResultByDefault: true\r\n  };\r\n\r\n  const middleware = model.hooks.filter(hook => {\r\n    const contexts = _getContexts(hook);\r\n    if (hook.name === 'updateOne') {\r\n      return contexts.query == null || !!contexts.query;\r\n    }\r\n    if (hook.name === 'deleteOne') {\r\n      return !!contexts.query || Object.keys(contexts).length === 0;\r\n    }\r\n    if (hook.name === 'validate' || hook.name === 'remove') {\r\n      return !!contexts.query;\r\n    }\r\n    if (hook.query != null || hook.document != null) {\r\n      return !!hook.query;\r\n    }\r\n    return true;\r\n  });\r\n\r\n  // `update()` thunk has a different name because `_update` was already taken\r\n  Query.prototype._execUpdate = middleware.createWrapper('update',\r\n    Query.prototype._execUpdate, null, kareemOptions);\r\n  // `distinct()` thunk has a different name because `_distinct` was already taken\r\n  Query.prototype.__distinct = middleware.createWrapper('distinct',\r\n    Query.prototype.__distinct, null, kareemOptions);\r\n\r\n  // `validate()` doesn't have a thunk because it doesn't execute a query.\r\n  Query.prototype.validate = middleware.createWrapper('validate',\r\n    Query.prototype.validate, null, kareemOptions);\r\n\r\n  applyQueryMiddleware.middlewareFunctions.\r\n    filter(v => v !== 'update' && v !== 'distinct' && v !== 'validate').\r\n    forEach(fn => {\r\n      Query.prototype[`_${fn}`] = middleware.createWrapper(fn,\r\n        Query.prototype[`_${fn}`], null, kareemOptions);\r\n    });\r\n}\r\n\r\nfunction _getContexts(hook) {\r\n  const ret = {};\r\n  if (hook.hasOwnProperty('query')) {\r\n    ret.query = hook.query;\r\n  }\r\n  if (hook.hasOwnProperty('document')) {\r\n    ret.document = hook.document;\r\n  }\r\n  return ret;\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}